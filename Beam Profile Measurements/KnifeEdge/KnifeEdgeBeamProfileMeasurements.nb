(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    146914,       3234]
NotebookOptionsPosition[    145303,       3182]
NotebookOutlinePosition[    145814,       3202]
CellTagsIndexPosition[    145771,       3199]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
This script is a part of ANGEL project.
V 1.5.2
2017.12.14
(C) Vulpes Corsac\
\>", "Text",
 CellChangeTimes->{{3.698631723375579*^9, 3.698631756693108*^9}, {
   3.707724943191782*^9, 3.7077249652176847`*^9}, 3.708682701771117*^9, {
   3.708872513384708*^9, 3.70887251653994*^9}, {3.708948152543004*^9, 
   3.7089481566671505`*^9}, {3.709382882519931*^9, 3.7093828857203445`*^9}, 
   3.7095211913790073`*^9, {3.70995268170761*^9, 3.70995268290483*^9}, {
   3.709956434123373*^9, 3.7099564363265305`*^9}, {3.7099577600998707`*^9, 
   3.7099577601779966`*^9}, {3.7100801857570066`*^9, 3.71008021733904*^9}, {
   3.710846771479193*^9, 3.710846783745002*^9}, {3.7158436218580685`*^9, 
   3.7158436301804357`*^9}, {3.722236995350196*^9, 3.7222370002798815`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Variables", " ", "clearing"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6973581388029823`*^9, 3.6973581642219124`*^9}, {
   3.697365957694203*^9, 3.697365959241111*^9}, 3.6974430739252667`*^9, {
   3.697444738529327*^9, 3.697444738701192*^9}, {3.697598437277643*^9, 
   3.6975984523246727`*^9}, {3.698203601826412*^9, 3.6982036023177586`*^9}, {
   3.698203788454876*^9, 3.698203799394716*^9}, {3.6982038797358456`*^9, 
   3.6982038826589146`*^9}, 3.6982041330446186`*^9, {3.698212632888794*^9, 
   3.6982126371789093`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Including", " ", "Package", " ", "to", " ", "use", " ", "ErrorBar", " ", 
    "plotting"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6982036034185486`*^9, 3.6982036119520226`*^9}, {
   3.698203681280147*^9, 3.698203681610381*^9}, {3.6982037590061197`*^9, 
   3.698203764354443*^9}, {3.6982038845232315`*^9, 3.6982039096654925`*^9}, 
   3.6982041346317387`*^9, {3.6982126458740873`*^9, 3.6982126657664747`*^9}, {
   3.6982127012158594`*^9, 3.698212714211647*^9}, {3.698214264346766*^9, 
   3.698214264777583*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Manual", " ", "settings"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]", "=", "1550"}], ";"}], 
   RowBox[{"(*", " ", "Wavelength", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"importDir", "=", "\"\<ImportData\>\""}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
    "Directory", " ", "for", " ", "raw", " ", "data", " ", "importing"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exportDir", "=", "\"\<ExportData\>\""}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
    "Directory", " ", "for", " ", "calculated", " ", "data", " ", 
     "exporting"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AllData", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"\"\<dataSample.xlsx\>\"", ",", " ", 
       RowBox[{"Path", "->", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", " ", "]"}], ",", "importDir"}], 
          "}"}], "]"}]}]}], "]"}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"Filename", " ", "with", " ", "input", " ", "data"}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UsePowerNoise", "=", "True"}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Whether", " ", "to", " ", "use", " ", "power", " ", "noise", " ", 
      RowBox[{"(", 
       RowBox[{
       "zero", " ", "power", " ", "is", " ", "actually", " ", "not", " ", 
        "zero"}], ")"}]}], " ", ":", " ", 
     RowBox[{
      RowBox[{"True", " ", "-", " ", "yes"}], " ", "|", " ", 
      RowBox[{"False", " ", "-", " ", "no"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6973598364690266`*^9, 3.697359836977397*^9}, {
   3.6973629704138684`*^9, 3.697363008373128*^9}, {3.697364050899366*^9, 
   3.697364065028609*^9}, {3.6973649938948774`*^9, 3.6973650094316883`*^9}, {
   3.697365046851079*^9, 3.697365047069833*^9}, {3.6973652423381615`*^9, 
   3.6973652764907265`*^9}, {3.697366305693297*^9, 3.697366325707225*^9}, {
   3.6973666497419863`*^9, 3.697366666423933*^9}, {3.6973666979185677`*^9, 
   3.697366698074823*^9}, {3.6973667289063177`*^9, 3.697366729031319*^9}, 
   3.6973677293730993`*^9, {3.6974428486294737`*^9, 3.697442873645355*^9}, 
   3.697443090909816*^9, {3.697443250419096*^9, 3.697443281919419*^9}, {
   3.6974440593021517`*^9, 3.69744407018289*^9}, {3.6974444226033363`*^9, 
   3.6974444290222964`*^9}, {3.6974444777167587`*^9, 3.6974444829458885`*^9}, 
   3.6974445232108727`*^9, {3.697444745203722*^9, 3.6974447836038427`*^9}, 
   3.697444827617198*^9, {3.6974454099398837`*^9, 3.697445514130409*^9}, {
   3.6974456014312167`*^9, 3.6974456019014835`*^9}, {3.697445632236891*^9, 
   3.697445735978535*^9}, {3.697445983746617*^9, 3.697445984550929*^9}, {
   3.697446102768617*^9, 3.697446103165493*^9}, {3.697465702433534*^9, 
   3.6974657083377137`*^9}, {3.697467898158943*^9, 3.6974678987243423`*^9}, {
   3.6974684472364435`*^9, 3.697468447883891*^9}, {3.6974685052725143`*^9, 
   3.697468505655785*^9}, 3.6975989241504188`*^9, {3.697598985686001*^9, 
   3.697598986125312*^9}, {3.6975991051445403`*^9, 3.69759910524162*^9}, {
   3.697599149250436*^9, 3.697599149659726*^9}, 3.6975992095711246`*^9, 
   3.6978634123341107`*^9, 3.6978641823085747`*^9, {3.6978645219083233`*^9, 
   3.6978645288132963`*^9}, {3.6978670589889336`*^9, 
   3.6978670593483114`*^9}, {3.69786748999487*^9, 3.6978674900729957`*^9}, {
   3.697867786630123*^9, 3.6978678031732926`*^9}, {3.697867863175565*^9, 
   3.6978678654412107`*^9}, 3.6978679709810762`*^9, {3.697868482131365*^9, 
   3.697868482540072*^9}, {3.697870069156531*^9, 3.6978701270500407`*^9}, {
   3.6978701573880587`*^9, 3.697870220803894*^9}, {3.697870267368946*^9, 
   3.6978702780449495`*^9}, {3.697871154417758*^9, 3.69787115454276*^9}, {
   3.697876748142831*^9, 3.697876748236581*^9}, 3.698049720043423*^9, 
   3.6980499956095753`*^9, {3.698054708297448*^9, 3.6980547290929904`*^9}, {
   3.6980547693247766`*^9, 3.6980548594943275`*^9}, {3.6980562239788733`*^9, 
   3.698056230493326*^9}, {3.6980744233868313`*^9, 3.6980744234962177`*^9}, {
   3.6980745503293695`*^9, 3.69807460144769*^9}, 3.6980746726506643`*^9, {
   3.6981203741880565`*^9, 3.6981203797602844`*^9}, {3.698120860939384*^9, 
   3.698120892744779*^9}, {3.6981211332430973`*^9, 3.69812113936117*^9}, {
   3.698203583336255*^9, 3.6982035840537615`*^9}, {3.6982041368202906`*^9, 
   3.69820414643911*^9}, {3.6982042994499817`*^9, 3.6982043008259373`*^9}, {
   3.6982052898098993`*^9, 3.698205290739562*^9}, 3.6982054390079317`*^9, 
   3.698205480817649*^9, {3.698205516318964*^9, 3.6982055350404515`*^9}, {
   3.698205566433426*^9, 3.698205575460657*^9}, {3.698205630005658*^9, 
   3.6982056348217945`*^9}, 3.698205856256792*^9, {3.6982059316267443`*^9, 
   3.698206009174417*^9}, {3.6982060555039454`*^9, 3.6982060914717884`*^9}, {
   3.698207307676897*^9, 3.6982073324960375`*^9}, {3.6982076266323156`*^9, 
   3.698207634161729*^9}, 3.6982084352203717`*^9, {3.698208701032281*^9, 
   3.6982087726996346`*^9}, {3.6982088044429817`*^9, 3.6982088070628543`*^9}, 
   3.6982091752469244`*^9, {3.698212721193429*^9, 3.6982127427363105`*^9}, {
   3.698212893721246*^9, 3.6982129119843454`*^9}, 3.6982129860775127`*^9, {
   3.6982131218761883`*^9, 3.6982132176366*^9}, {3.6982137615790586`*^9, 
   3.698213762256538*^9}, {3.6982142602528734`*^9, 3.6982142603539553`*^9}, {
   3.6983856177307777`*^9, 3.6983856213248177`*^9}, {3.698385701692748*^9, 
   3.6983857027732363`*^9}, {3.698565761290765*^9, 3.6985658076064806`*^9}, {
   3.698565845698386*^9, 3.6985658625462875`*^9}, {3.698565913560133*^9, 
   3.698565913860345*^9}, {3.7087427232257147`*^9, 3.7087427257164636`*^9}, {
   3.7087431309064913`*^9, 3.708743131320122*^9}, 3.7088280125506163`*^9, {
   3.708831786543814*^9, 3.708831786715675*^9}, 3.708832127789386*^9, 
   3.7088710179779053`*^9, {3.7088717628806133`*^9, 3.708871762977682*^9}, 
   3.7088724744155107`*^9, 3.7088737237821255`*^9, 3.709043256892039*^9, 
   3.709049247587592*^9, 3.709050385160661*^9, 3.709051109311593*^9, {
   3.709480949136423*^9, 3.7094809592680044`*^9}, {3.7094810010916443`*^9, 
   3.7094810013115263`*^9}, 3.7095202646766367`*^9, 3.7095203914897003`*^9, 
   3.709827255276211*^9, 3.7098284777843947`*^9, 3.709952228626487*^9, {
   3.709952303040962*^9, 3.7099523261625133`*^9}, {3.7099523639468737`*^9, 
   3.709952462712551*^9}, {3.7099567956015205`*^9, 3.7099567956796474`*^9}, 
   3.7099568295221148`*^9, 3.7099580188977633`*^9, 3.709958075386275*^9, {
   3.7100622344566975`*^9, 3.7100622352032423`*^9}, 3.7100802081406417`*^9, {
   3.7100804011689787`*^9, 3.7100804024290695`*^9}, {3.710080805472021*^9, 
   3.7100808055640154`*^9}, {3.710080840759534*^9, 3.710080901247759*^9}, {
   3.7102177043940067`*^9, 3.7102177117976933`*^9}, 3.7102421377866344`*^9, {
   3.710729567840043*^9, 3.7107295818663735`*^9}, 3.711867355253446*^9, 
   3.7118675982046566`*^9, 3.715493877432356*^9, 3.715843618714857*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "DO", " ", "NOT", " ", "TOUCH", " ", "ANYTHING", " ", "AFTERWARDS"}], " ",
     "-", " ", 
    RowBox[{"MAIN", " ", "SCRIPT", " ", "IS", " ", "THERE"}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6982137676060247`*^9, 3.698213770544849*^9}, 
   3.7086827080357995`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PrependTo", "[", 
    RowBox[{"AllData", ",", 
     RowBox[{"AllData", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Script", " ", "ignores", " ", "the", " ", "first", " ", "list", " ", "in",
     " ", "Exel", " ", 
    RowBox[{"file", ".", " ", "That"}], " ", "is", " ", "why", " ", "I", " ", 
    "copy", " ", "it", " ", "and", " ", "insert", " ", "it", " ", "in", " ", 
    "the", " ", "first", " ", "position"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6982039129893446`*^9, 3.698203982831132*^9}, 
   3.6982041483844943`*^9, 3.6982087087367306`*^9, {3.698212918191445*^9, 
   3.698212983279724*^9}, 3.6982132226281357`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "IT", " ", "DOES", " ", "NOT", " ", "WORK", " ", "AS", " ", "IT", " ", 
    RowBox[{"SHOULD", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Off", "[", 
     StyleBox[
      RowBox[{"CreateDirectory", "::", "filex"}], "MessageName"], 
     StyleBox["]", "MessageName"]}], 
    StyleBox[";", "MessageName"]}], 
   StyleBox[" ", "MessageName"], 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{
     "Turning", " ", "off", " ", "warning", " ", "message", " ", "about", " ",
       "creating", " ", "already", " ", "existing", " ", "directory"}], " ", 
     "*)"}], "MessageName"], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"importDir", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", " ", "]"}], ",", "importDir"}], 
       "}"}], "]"}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
    "Getting", " ", "full", " ", "export", " ", "directory", " ", "path"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exportDir", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", " ", "]"}], ",", "exportDir"}], 
       "}"}], "]"}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
    "Getting", " ", "full", " ", "export", " ", "directory", " ", "path"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", "exportDir", "]"}], ",", ",", 
      RowBox[{"CreateDirectory", "[", "exportDir", "]"}]}], "]"}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
    "Creating", " ", "directory", " ", "for", " ", "exporting", " ", "all", 
     " ", "calculated", " ", "data"}], " ", "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.697445860925886*^9, 3.6974459783829737`*^9}, 
   3.6975979423635063`*^9, {3.6975987728723717`*^9, 3.697598867772521*^9}, {
   3.698204005105886*^9, 3.698204020747952*^9}, {3.698204073459687*^9, 
   3.6982041015942326`*^9}, {3.698204155331668*^9, 3.6982041590670357`*^9}, 
   3.698209315699817*^9, {3.698209594469398*^9, 3.6982096709437075`*^9}, {
   3.6982127851164207`*^9, 3.6982128818561306`*^9}, {3.698213231557285*^9, 
   3.6982132505151553`*^9}, {3.698214273283616*^9, 3.698214273486759*^9}, {
   3.6985657733953047`*^9, 3.6985657784879117`*^9}, {3.6985658135026445`*^9, 
   3.6985658363497725`*^9}, {3.698565924551896*^9, 3.6985659275630236`*^9}, {
   3.6985659883229413`*^9, 3.698565989000419*^9}, {3.711027264938614*^9, 
   3.711027265425966*^9}, {3.7158436563919125`*^9, 3.715843656987334*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Experiments", " ", "=", " ", 
    RowBox[{"Length", "[", "AllData", "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Getting", " ", "experiment", " ", "points", " ", "ammount", " ", "as", 
    " ", "a", " ", "number", " ", "ol", " ", "lists", " ", "in", " ", "Exel", 
    " ", "file"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BeamERFPlot", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "Experiments"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Preparing", " ", "table", " ", "for", " ", "ERF", " ", "function", " ", 
    "data", " ", "plotting"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BeamERFExport", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "Experiments"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Preparing", " ", "table", " ", "for", " ", "ERF", " ", "function", " ", 
    "data", " ", "exporting"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BeamGaussPlot", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "Experiments"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Preparing", " ", "table", " ", "for", " ", "Gauss", " ", "function", " ", 
    "data", " ", "plotting"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BeamGaussExport", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "Experiments"}], "}"}]}], "]"}]}], ";"}], 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Preparing", " ", "table", " ", "for", " ", "Gauss", " ", "function", " ", 
    "data", " ", "exporting"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BeamERFCenterExport", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "Experiments"}], "}"}]}], "]"}]}], ";"}], 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Preparing", " ", "table", " ", "for", " ", "ERF", " ", "beam", " ", 
    "center", " ", "exporting"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BeamGaussCenterExport", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "Experiments"}], "}"}]}], "]"}]}], ";"}], 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Preparing", " ", "table", " ", "for", " ", "Gauss", " ", "beam", " ", 
    "center", " ", "exporting"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BeamERFCenterPlot", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "Experiments"}], "}"}]}], "]"}]}], ";"}], 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Preparing", " ", "table", " ", "for", " ", "ERF", " ", "beam", " ", 
    "center", " ", "plotting"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BeamGaussCenterPlot", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "Experiments"}], "}"}]}], "]"}]}], ";"}], 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Preparing", " ", "table", " ", "for", " ", "Gauss", " ", "beam", " ", 
    "center", " ", "plotting"}], " ", 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.6974540573173265`*^9, {3.697454833749712*^9, 3.6974548370051837`*^9}, {
   3.697464576757116*^9, 3.6974645796201534`*^9}, 3.697465469091366*^9, {
   3.697867445378707*^9, 3.697867462571959*^9}, 3.6978675042264957`*^9, {
   3.6982041041250205`*^9, 3.6982041286442375`*^9}, {3.6982041632823324`*^9, 
   3.698204233675768*^9}, {3.6982043320131073`*^9, 3.698204337026143*^9}, {
   3.698205579351659*^9, 3.6982055800071106`*^9}, {3.698213317335082*^9, 
   3.69821338919689*^9}, {3.69821425126167*^9, 3.6982142514718294`*^9}, {
   3.709382520965819*^9, 3.709382543703492*^9}, {3.7093825758244104`*^9, 
   3.7093825910135593`*^9}, {3.709382673895646*^9, 3.709382716084467*^9}, {
   3.7093828059751606`*^9, 3.7093828105599155`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PmeasuredErf", "[", 
     RowBox[{
     "P0_", ",", "P1_", ",", "P2_", ",", "P3_", ",", "Px_", ",", "Sgn_"}], 
     "]"}], ":=", 
    RowBox[{"P0", "+", 
     RowBox[{
      FractionBox["P1", "2"], "\[Times]", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"Sign", "[", "Sgn", "]"}], "\[Times]", 
         RowBox[{"Erf", "[", 
          FractionBox[
           RowBox[{
            SqrtBox["2"], 
            RowBox[{"(", 
             RowBox[{"Px", "-", "P2"}], ")"}]}], "P3"], "]"}]}]}], 
       ")"}]}]}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"ERF", " ", "fitting", " ", "function"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GaussFunction", "[", 
     RowBox[{"y0_", ",", "A_", ",", "xc_", ",", "\[Sigma]_", ",", "x_"}], 
     "]"}], ":=", 
    RowBox[{"y0", "+", 
     RowBox[{"A", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "xc"}], ")"}], "2"], 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Sigma]", "2"]}]]}], "]"}]}]}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Gauss", " ", "fitting", " ", "function"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BeamPropogationFunction", "[", 
    RowBox[{"A2_", ",", "A1_", ",", "A0_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Re", "[", 
    SqrtBox[
     RowBox[{
      RowBox[{"A2", " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{"A1", " ", "x"}], "+", "A0"}]], "]"}]}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Hyperbolic", " ", "fitting", " ", "function", " ", "for", " ", "beam", 
    " ", "parameters", " ", "calculation"}], " ", "*)"}], 
  "\[IndentingNewLine]"}]}], "Input",
 CellChangeTimes->{{3.697359271305389*^9, 3.6973593805116844`*^9}, {
   3.69735954477265*^9, 3.697359557497655*^9}, {3.697443230762641*^9, 
   3.6974432349501715`*^9}, {3.6974442718317595`*^9, 3.697444283056505*^9}, {
   3.6974443305943527`*^9, 3.697444334871174*^9}, {3.6974444918815527`*^9, 
   3.6974445112721233`*^9}, {3.6974554500012197`*^9, 
   3.6974554833189287`*^9}, {3.697455571092414*^9, 3.697455571311165*^9}, {
   3.697463597400818*^9, 3.6974636023243074`*^9}, {3.6974637125247374`*^9, 
   3.697463715924856*^9}, {3.698204345094881*^9, 3.698204388921438*^9}, 
   3.69820458484219*^9, {3.6982068508608913`*^9, 3.6982068668389206`*^9}, {
   3.698213264060999*^9, 3.698213305271632*^9}, {3.709482159159608*^9, 
   3.7094821829246798`*^9}, 3.709519584440136*^9, 3.710846696996733*^9, {
   3.710846731343042*^9, 3.7108467407650566`*^9}, {3.7222370088337765`*^9, 
   3.722237014353733*^9}, {3.722242462002226*^9, 3.7222424771137185`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Beam", " ", "parameters", " ", "calculation", " ", "via", " ", 
    "hyperbolic", " ", "fitting"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GetBeamPropogationFit", "[", 
     RowBox[{"data_List", ",", "Mode_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dataFit", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Getting", " ", "round", " ", "data"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"nlm", "=", 
       RowBox[{"NonlinearModelFit", "[", 
        RowBox[{"dataFit", ",", 
         RowBox[{"BeamPropogationFunction", "[", 
          RowBox[{"A2", ",", "A1", ",", "A0", ",", "x"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"A2", ",", "A1", ",", "A0"}], "}"}], ",", "x"}], "]"}]}], 
      ";", 
      RowBox[{"(*", " ", "Fitting", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"parametersTable", " ", "=", " ", 
       RowBox[{"nlm", "[", "\"\<ParameterTable\>\"", "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Getting", " ", "fitting", " ", "parameters", " ", "table"}], 
        ",", " ", 
        RowBox[{
        "and", " ", "coefficients", " ", "and", " ", "their", " ", 
         "errors"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumericQ", "[", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"nlm", "[", "\"\<RSquared\>\"", "]"}], "]"}], "]"}], ",", 
        RowBox[{"R2", "=", 
         RowBox[{"ToString", "[", 
          RowBox[{"nlm", "[", "\"\<RSquared\>\"", "]"}], "]"}]}], ",", 
        RowBox[{"R2", "=", "\"\<UNDEFINED\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A2fit", "=", 
       RowBox[{"parametersTable", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", 
      RowBox[{"\[Delta]A2fit", "=", 
       RowBox[{"parametersTable", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "2", ",", "3"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A1fit", "=", 
       RowBox[{"parametersTable", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "3", ",", "2"}], "]"}], "]"}]}], ";", 
      RowBox[{"\[Delta]A1fit", "=", 
       RowBox[{"parametersTable", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "3", ",", "3"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A0fit", "=", 
       RowBox[{"parametersTable", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "4", ",", "2"}], "]"}], "]"}]}], ";", 
      RowBox[{"\[Delta]A0fit", "=", 
       RowBox[{"parametersTable", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "4", ",", "3"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Parameters", " ", "from", " ", "\:0413\:041e\:0421\:0422", " ", 
        RowBox[{"(", "ISO", ")"}], " ", "and", " ", "their", " ", "errors"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"z0", "=", 
       FractionBox[
        RowBox[{"-", "A1fit"}], 
        RowBox[{"2", "A2fit"}]]}], ";", 
      RowBox[{"\[Delta]z0", "=", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "A2fit"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"-", "\[Delta]A1fit"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "A1fit"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"2", "\[Delta]A2fit"}], ")"}]}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"2", "A2fit"}], ")"}], "2"]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d\[Sigma]0", "=", 
       RowBox[{"Re", "[", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", 
           SqrtBox["A2fit"]}]], 
         SqrtBox[
          RowBox[{
           RowBox[{"4", "A0fit", " ", "A2fit"}], "-", 
           SuperscriptBox["A1fit", "2"]}]]}], "]"}]}], ";", 
      RowBox[{"\[Delta]d\[Sigma]0", "=", 
       RowBox[{"Re", "[", 
        RowBox[{
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"2", 
             SqrtBox["A2fit"]}], ")"}], "2"]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", 
              SqrtBox["A2fit"]}], ")"}], " ", 
            RowBox[{"(", 
             FractionBox[
              RowBox[{
               RowBox[{"4", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"A0fit", " ", "\[Delta]A2fit"}], "+", 
                  RowBox[{"A2fit", " ", "\[Delta]A0fit"}]}], ")"}]}], "+", 
               RowBox[{"2", " ", "A1fit", " ", "\[Delta]A1fit"}]}], 
              RowBox[{"2", " ", 
               SqrtBox[
                RowBox[{
                 RowBox[{"4", "A0fit", " ", "A2fit"}], "-", 
                 SuperscriptBox["A1fit", "2"]}]]}]], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             SqrtBox[
              RowBox[{
               RowBox[{"4", "A0fit", " ", "A2fit"}], "-", 
               SuperscriptBox["A1fit", "2"]}]], ")"}], 
            RowBox[{"(", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              FractionBox["\[Delta]A2fit", 
               RowBox[{"2", " ", "A2fit"}]]}], ")"}]}]}], ")"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalTheta]\[Sigma]", "=", 
       RowBox[{"Re", "[", 
        SqrtBox["A2fit"], "]"}]}], ";", 
      RowBox[{"\[Delta]\[CapitalTheta]\[Sigma]", "=", 
       RowBox[{"Re", "[", 
        FractionBox["\[Delta]A2fit", 
         RowBox[{"2", " ", "A2fit"}]], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"zR", "=", 
       RowBox[{"Re", "[", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", "A2fit"}]], 
         SqrtBox[
          RowBox[{
           RowBox[{"4", "A0fit", " ", "A2fit"}], "-", 
           SuperscriptBox["A1fit", "2"]}]]}], "]"}]}], ";", 
      RowBox[{"\[Delta]zR", "=", 
       RowBox[{"Re", "[", 
        RowBox[{
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"2", "A2fit"}], ")"}], "2"]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "A2fit"}], ")"}], " ", 
            RowBox[{"(", 
             FractionBox[
              RowBox[{
               RowBox[{"4", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"A0fit", " ", "\[Delta]A2fit"}], "+", 
                  RowBox[{"A2fit", " ", "\[Delta]A0fit"}]}], ")"}]}], "+", 
               RowBox[{"2", " ", "A1fit", " ", "\[Delta]A1fit"}]}], 
              RowBox[{"2", " ", 
               SqrtBox[
                RowBox[{
                 RowBox[{"4", "A0fit", " ", "A2fit"}], "-", 
                 SuperscriptBox["A1fit", "2"]}]]}]], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             SqrtBox[
              RowBox[{
               RowBox[{"4", "A0fit", " ", "A2fit"}], "-", 
               SuperscriptBox["A1fit", "2"]}]], ")"}], 
            RowBox[{"(", 
             RowBox[{"2", "\[Delta]A2fit"}], ")"}]}]}], ")"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"M2", "=", 
       RowBox[{"Re", "[", 
        RowBox[{
         FractionBox["\[Pi]", 
          RowBox[{"8", "\[Lambda]"}]], 
         SqrtBox[
          RowBox[{
           RowBox[{"4", "A0fit", " ", "A2fit"}], "-", 
           SuperscriptBox["A1fit", "2"]}]]}], "]"}]}], ";", 
      RowBox[{"\[Delta]M2", "=", 
       RowBox[{"Re", "[", 
        RowBox[{
         FractionBox["\[Pi]", 
          RowBox[{"8", "\[Lambda]"}]], 
         FractionBox[
          RowBox[{
           RowBox[{"4", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"A0fit", " ", "\[Delta]A2fit"}], "+", 
              RowBox[{"A2fit", " ", "\[Delta]A0fit"}]}], ")"}]}], "+", 
           RowBox[{"2", " ", "A1fit", " ", "\[Delta]A1fit"}]}], 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{
             RowBox[{"4", "A0fit", " ", "A2fit"}], "-", 
             SuperscriptBox["A1fit", "2"]}]]}]]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BeamRadiusesFitString", "=", 
       RowBox[{
       "\"\<Beam diameters \>\"", "<>", "Mode", "<>", " ", 
        "\"\< fit ( Sqrt[A2*x^2+A1*x+A0] ) :\>\"", "<>", "\"\<\\n\\t\>\"", "<>",
         " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Forming", " ", "string", " ", "with", " ", "all", " ", "parameters",
           " ", "for", " ", "later", " ", "export"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\"\<A2 = \>\"", "<>", 
        RowBox[{"ToString", "[", "A2fit", "]"}], "<>", 
        "\"\< \[PlusMinus] \>\"", "<>", 
        RowBox[{"ToString", "[", "\[Delta]A2fit", "]"}], "<>", 
        "\"\<, t.m. \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"100", "\[Times]", 
          RowBox[{"Abs", "[", 
           FractionBox["\[Delta]A2fit", "A2fit"], "]"}]}], "]"}], "<>", 
        "\"\< %\>\"", "<>", "\"\<\\n\\t\>\"", "<>", "\[IndentingNewLine]", 
        "\"\<A1 = \>\"", "<>", 
        RowBox[{"ToString", "[", "A1fit", "]"}], "<>", 
        "\"\< \[PlusMinus] \>\"", "<>", 
        RowBox[{"ToString", "[", "\[Delta]A1fit", "]"}], "<>", 
        "\"\<, t.m. \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"100", "\[Times]", 
          RowBox[{"Abs", "[", 
           FractionBox["\[Delta]A1fit", "A1fit"], "]"}]}], "]"}], "<>", 
        "\"\< %\>\"", "<>", "\"\<\\n\\t\>\"", "<>", "\[IndentingNewLine]", 
        "\"\<A0 = \>\"", "<>", 
        RowBox[{"ToString", "[", "A0fit", "]"}], "<>", 
        "\"\< \[PlusMinus] \>\"", "<>", 
        RowBox[{"ToString", "[", "\[Delta]A0fit", "]"}], "<>", 
        "\"\<, t.m. \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"100", "\[Times]", 
          RowBox[{"Abs", "[", 
           FractionBox["\[Delta]A0fit", "A0fit"], "]"}]}], "]"}], "<>", 
        "\"\< %\>\"", "<>", "\"\<\\n\>\"", "<>", "\[IndentingNewLine]", 
        "\"\<From \:0413\:041e\:0421\:0422 \:0420 \:0418\:0421\:041e \
11146-1-2008-1 ( ISO 11146-1:2005 ):\>\"", "<>", "\"\<\\n\\t\>\"", "<>", 
        "\[IndentingNewLine]", "\"\<z0[waist coordinate] = \>\"", "<>", 
        RowBox[{"ToString", "[", "z0", "]"}], "<>", "\"\< \[PlusMinus] \>\"", 
        "<>", 
        RowBox[{"ToString", "[", "\[Delta]z0", "]"}], "<>", "\"\<, t.m. \>\"",
         "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"100", "\[Times]", 
          RowBox[{"Abs", "[", 
           FractionBox["\[Delta]z0", "z0"], "]"}]}], "]"}], "<>", 
        "\"\< %\>\"", "<>", "\"\<\\n\\t\>\"", "<>", "\[IndentingNewLine]", 
        "\"\<d_sigma0[waist]= \>\"", "<>", 
        RowBox[{"ToString", "[", "d\[Sigma]0", "]"}], "<>", 
        "\"\< \[PlusMinus] \>\"", "<>", 
        RowBox[{"ToString", "[", "\[Delta]d\[Sigma]0", "]"}], "<>", 
        "\"\<, t.m. \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"100", "\[Times]", 
          RowBox[{"Abs", "[", 
           FractionBox["\[Delta]d\[Sigma]0", "d\[Sigma]0"], "]"}]}], "]"}], "<>",
         "\"\< %\>\"", "<>", "\"\<\\n\\t\>\"", "<>", "\[IndentingNewLine]", 
        "\"\<Theta_sigma[divergence angle] = \>\"", "<>", 
        RowBox[{"ToString", "[", "\[CapitalTheta]\[Sigma]", "]"}], "<>", 
        "\"\< \[PlusMinus] \>\"", "<>", 
        RowBox[{"ToString", "[", "\[Delta]\[CapitalTheta]\[Sigma]", "]"}], 
        "<>", "\"\<, t.m. \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"100", "\[Times]", 
          RowBox[{"Abs", "[", 
           
           FractionBox["\[Delta]\[CapitalTheta]\[Sigma]", 
            "\[CapitalTheta]\[Sigma]"], "]"}]}], "]"}], "<>", "\"\< %\>\"", 
        "<>", "\"\<\\n\\t\>\"", "<>", "\[IndentingNewLine]", 
        "\"\<z_R[Rayleigh distance] = \>\"", "<>", 
        RowBox[{"ToString", "[", "zR", "]"}], "<>", "\"\< \[PlusMinus] \>\"", 
        "<>", 
        RowBox[{"ToString", "[", "\[Delta]zR", "]"}], "<>", "\"\<, t.m. \>\"",
         "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"100", "\[Times]", 
          RowBox[{"Abs", "[", 
           FractionBox["\[Delta]zR", "zR"], "]"}]}], "]"}], "<>", 
        "\"\< %\>\"", "<>", "\"\<\\n\\t\>\"", "<>", "\[IndentingNewLine]", 
        "\"\<M2[Beam quality] = \>\"", "<>", 
        RowBox[{"ToString", "[", "M2", "]"}], "<>", "\"\< \[PlusMinus] \>\"", 
        "<>", 
        RowBox[{"ToString", "[", "\[Delta]M2", "]"}], "<>", "\"\<, t.m. \>\"",
         "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"100", "\[Times]", 
          RowBox[{"Abs", "[", 
           FractionBox["\[Delta]M2", "M2"], "]"}]}], "]"}], "<>", 
        "\"\< %\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"exportDir", ",", 
           RowBox[{
           "\"\<BeamPropogation\>\"", "<>", "Mode", "<>", 
            "\"\<Fit.txt\>\""}]}], "}"}], "]"}], ",", 
        "BeamRadiusesFitString"}], "]"}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Exporting", " ", "string", " ", "from", " ", "above"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"BeamRadiusesPlot", "=", 
       RowBox[{"Show", "[", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Plotting", " ", "data", " ", "and", " ", "fit", " ", "on", " ", 
          "the", " ", "same", " ", "plot"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ErrorListPlot", "[", 
          RowBox[{"data", ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"Joined", "\[Rule]", "False"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{
            "\"\<Beam diameter dependency fitting with \>\"", "<>", "Mode", 
             "<>", "\"\<, \!\(\*SuperscriptBox[\(R\), \(2\)]\) = \>\"", "<>", 
             "R2"}]}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<Knife z\>\"", ",", "\"\<Beam diameter\>\""}], 
             "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"BeamPropogationFunction", "[", 
            RowBox[{"A2fit", ",", "A1fit", ",", "A0fit", ",", "x"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Min", "[", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"ColorFunction", "\[Rule]", 
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], ",", "Red"}], "]"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"exportDir", ",", 
           RowBox[{
           "\"\<BeamPropogation\>\"", "<>", "Mode", "<>", 
            "\"\<Plot.png\>\""}]}], "}"}], "]"}], ",", "BeamRadiusesPlot"}], 
       "]"}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Exporting", " ", "plot", " ", "from", " ", "above"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "BeamRadiusesPlot", "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.697453967438715*^9, 3.6974539913011312`*^9}, 
   3.6974540452668595`*^9, 3.6974542015271983`*^9, {3.6974543877869663`*^9, 
   3.697454411508785*^9}, {3.697454467762627*^9, 3.697454468606386*^9}, {
   3.697454769957274*^9, 3.6974548214953675`*^9}, {3.697454862163704*^9, 
   3.697455045206785*^9}, 3.697455117696123*^9, {3.697455157411783*^9, 
   3.6974551576149073`*^9}, {3.6974552724339514`*^9, 
   3.6974552941396713`*^9}, {3.6974636001768184`*^9, 
   3.6974636005872984`*^9}, {3.6974682056701097`*^9, 
   3.6974682162759295`*^9}, {3.6975982838699245`*^9, 3.6975983235890665`*^9}, 
   3.6982044292201247`*^9, {3.698206337511813*^9, 3.6982065343757195`*^9}, {
   3.6982065656903696`*^9, 3.6982066176282825`*^9}, {3.6982068833159685`*^9, 
   3.6982069179042873`*^9}, 3.6982069902933054`*^9, {3.698207020912263*^9, 
   3.6982070254544706`*^9}, {3.698207063996084*^9, 3.6982072955756607`*^9}, {
   3.6982073723106337`*^9, 3.698207449671037*^9}, {3.6982075095227275`*^9, 
   3.6982075208922396`*^9}, {3.6982076048584642`*^9, 3.698207669281129*^9}, {
   3.698207786590548*^9, 3.6982077952977047`*^9}, {3.698208265361865*^9, 
   3.6982082922212753`*^9}, 3.698208856768279*^9, {3.698209689114785*^9, 
   3.6982097303018656`*^9}, {3.698213442598168*^9, 3.6982134668009233`*^9}, {
   3.6982140570936584`*^9, 3.698214244543375*^9}, {3.69821431130515*^9, 
   3.698214349781048*^9}, {3.69822715110609*^9, 3.6982272294413795`*^9}, {
   3.6982272757485695`*^9, 3.6982272890069523`*^9}, {3.6982273591025496`*^9, 
   3.6982274016195965`*^9}, {3.698227448153823*^9, 3.698227481678337*^9}, {
   3.698227532830266*^9, 3.698227604731865*^9}, {3.6982276496213565`*^9, 
   3.698227734931858*^9}, {3.6982280856971536`*^9, 3.698228093879611*^9}, {
   3.6982281696011887`*^9, 3.6982281725338583`*^9}, {3.698228265355044*^9, 
   3.6982282668231397`*^9}, {3.6982283037244225`*^9, 
   3.6982286125655813`*^9}, {3.6983848799698553`*^9, 
   3.6983848963563757`*^9}, {3.698385476092315*^9, 3.698385492400729*^9}, {
   3.6983904882738323`*^9, 3.698390510153287*^9}, {3.698390555405114*^9, 
   3.6983905572624254`*^9}, {3.698390631463838*^9, 3.6983906341597424`*^9}, {
   3.698566026836136*^9, 3.6985660312552557`*^9}, {3.698632639125039*^9, 
   3.698632641006011*^9}, {3.7095213229887238`*^9, 3.7095213232955537`*^9}, {
   3.710079773463644*^9, 3.710079775267423*^9}, {3.7100801307384663`*^9, 
   3.710080147775819*^9}, {3.710080443982316*^9, 3.710080524273046*^9}, {
   3.7100806287135277`*^9, 3.7100807104426513`*^9}, {3.722237038499226*^9, 
   3.722237109603122*^9}, {3.722242505533782*^9, 3.7222425157740183`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Calculating", " ", "first", " ", "derivative", " ", "as", " ", "it", " ", 
    "is", " ", "in", " ", "Origin"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MyDerivative", "[", "x_List", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", "=", 
       RowBox[{"List", "[", "]"}]}], ";", 
      RowBox[{"len", "=", 
       RowBox[{"Length", "[", "x", "]"}]}], ";", 
      RowBox[{"For", "[", " ", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", 
        RowBox[{"i", " ", "\[LessEqual]", " ", "len"}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{"Which", "[", 
         RowBox[{"(*", " ", 
          RowBox[{"For", " ", "all", " ", "points"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"i", "\[Equal]", "1"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"d", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Abs", "[", 
               FractionBox[
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}], "-", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}]}], 
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}]], "]"}]}], "}"}]}],
            "]"}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{"First", " ", "point"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"i", ">", "1"}], " ", "&&", " ", 
           RowBox[{"i", "<", "len"}]}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"d", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Abs", "[", 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], 
                   RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}]], "+", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2"}], "]"}], "]"}]}], 
                   RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}]]}], 
                 ")"}]}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{"First", " ", "derivative", " ", "calculating"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"i", "\[Equal]", "len"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"d", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Abs", "[", 
               FractionBox[
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2"}], "]"}], "]"}]}], 
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}]], 
               "]"}]}], "}"}]}], "]"}]}], 
         RowBox[{"(*", " ", 
          RowBox[{"Last", " ", "point"}], " ", "*)"}], "\[IndentingNewLine]", 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "d", "]"}]}], "\[IndentingNewLine]", ")"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.69746005268499*^9, 3.697460058244007*^9}, {
   3.6974601021791573`*^9, 3.6974601123370757`*^9}, {3.6974602749130945`*^9, 
   3.6974603720789995`*^9}, 3.6974604645469713`*^9, {3.6974605523692017`*^9, 
   3.697460639756999*^9}, {3.697460814460603*^9, 3.697461086500678*^9}, {
   3.69746113212068*^9, 3.6974611445399475`*^9}, {3.697461258806044*^9, 
   3.6974612642952113`*^9}, {3.697461653000186*^9, 3.697461699568283*^9}, {
   3.6974624997201877`*^9, 3.697462754122768*^9}, {3.6974647048797874`*^9, 
   3.6974647395821013`*^9}, {3.697464991181533*^9, 3.6974650065183973`*^9}, {
   3.697465136834865*^9, 3.697465137396263*^9}, {3.6982062968750863`*^9, 
   3.6982063208470936`*^9}, {3.6982066241108837`*^9, 
   3.6982067111304913`*^9}, {3.698214365132541*^9, 3.69821445265318*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Calculating", " ", "beam", " ", "profile", " ", "fitting", " ", "with", 
    " ", "ERF"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CalculateERF", "[", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"ExperimentRound", "=", "1"}], ",", 
          RowBox[{"ExperimentRound", "<", "Experiments"}], ",", 
          RowBox[{
           RowBox[{"ExperimentRound", "+=", "1"}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"For", " ", "all", " ", "experiments", " ", 
             RowBox[{"(", 
              RowBox[{
              "all", " ", "lists", " ", "in", " ", "Exel", " ", "file"}], 
              ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"zStep", "=", 
            RowBox[{"AllData", "[", 
             RowBox[{"[", 
              RowBox[{"ExperimentRound", ",", "1", ",", "1"}], "]"}], "]"}]}],
            ";", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Z", " ", "coordinate", " ", "for", " ", "current", " ", 
             "experiment"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Data", "=", 
            RowBox[{"AllData", "[", 
             RowBox[{"[", 
              RowBox[{"ExperimentRound", ",", 
               RowBox[{"3", ";;"}], ",", 
               RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"Round", " ", "data"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Sgn", "=", 
            RowBox[{"Sign", "[", 
             RowBox[{
              RowBox[{"Data", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], "-", 
              RowBox[{"Data", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"Sign", " ", "in", " ", "ERF", " ", "formula"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"UsePowerNoise", ",", 
             RowBox[{"PowerNoise", "=", 
              RowBox[{"Min", "[", 
               RowBox[{"Data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"PowerNoise", "=", "0"}]}], "]"}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "If", " ", "we", " ", "need", " ", "power", " ", "noize", " ", 
              "fitting"}], ",", " ", 
             RowBox[{
             "it", " ", "is", " ", "Min", " ", "from", " ", "all", " ", 
              "Data"}], ",", " ", 
             RowBox[{"otherwise", " ", "-", " ", "0"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"BeamPower", "=", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"Data", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", 
             "PowerNoise"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{
            "All", " ", "beam", " ", "power", " ", "is", " ", "Max", " ", 
             "minus", " ", "power", " ", "noize"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"BeamRadius", "=", 
            FractionBox[
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"Data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "-", 
              RowBox[{"Min", "[", 
               RowBox[{"Data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "2"]}], 
           ";", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Beam", " ", "radius", " ", "must", " ", "be", " ", "less", " ", 
             "then", " ", "half", " ", "of", " ", "data", " ", "range"}], " ",
             "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"UsePowerNoise", ",", 
             RowBox[{"(*", " ", 
              RowBox[{
              "If", " ", "there", " ", "is", " ", "power", " ", "noize"}], 
              " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"nlm", "=", 
              RowBox[{"NonlinearModelFit", "[", 
               RowBox[{"Data", ",", 
                RowBox[{"PmeasuredErf", "[", 
                 RowBox[{
                 "P0", ",", "P1", ",", "P2", ",", "P3", ",", "Px", ",", 
                  "Sgn"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"P0", ",", "PowerNoise"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"P1", ",", "BeamPower"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"P2", ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"Data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "+", 
                    RowBox[{"Max", "[", 
                    RowBox[{"Data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "2"]}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"P3", ",", "BeamRadius"}], "}"}]}], "}"}], ",", 
                "Px"}], "]"}]}], ",", 
             RowBox[{"(*", " ", 
              RowBox[{"Fitting", " ", "with", " ", "noize"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"nlm", "=", 
              RowBox[{"NonlinearModelFit", "[", 
               RowBox[{"Data", ",", 
                RowBox[{"PmeasuredErf", "[", 
                 RowBox[{
                 "PowerNoise", ",", "P1", ",", "P2", ",", "P3", ",", "Px", 
                  ",", "Sgn"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"P1", ",", "BeamPower"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"P2", ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"Data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "+", 
                    RowBox[{"Max", "[", 
                    RowBox[{"Data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "2"]}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"P3", ",", "BeamRadius"}], "}"}]}], "}"}], ",", 
                "Px"}], "]"}]}]}], 
            RowBox[{"(*", " ", 
             RowBox[{"Fitting", " ", "without", " ", "noize"}], " ", "*)"}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"parametersTable", " ", "=", " ", 
            RowBox[{"nlm", "[", "\"\<ParameterTable\>\"", "]"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"Getting", " ", "fitted", " ", "parameters"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NumericQ", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"nlm", "[", "\"\<RSquared\>\"", "]"}], "]"}], "]"}], 
             ",", 
             RowBox[{"R2", "=", 
              RowBox[{"ToString", "[", 
               RowBox[{"nlm", "[", "\"\<RSquared\>\"", "]"}], "]"}]}], ",", 
             RowBox[{"R2", "=", "\"\<UNDEFINED\>\""}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"parametersTable", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "\[Equal]", 
              "5"}], ",", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"If", " ", "with", " ", "noize"}], " ", "-", " ", 
               RowBox[{
               "there", " ", "are", " ", "less", " ", "parameters"}]}], " ", 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"P0fit", "=", 
               RowBox[{"parametersTable", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}]}], 
              ";", 
              RowBox[{"\[Delta]P0fit", "=", 
               RowBox[{"parametersTable", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1", ",", "2", ",", "3"}], "]"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"P1fit", "=", 
               RowBox[{"parametersTable", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1", ",", "3", ",", "2"}], "]"}], "]"}]}], 
              ";", 
              RowBox[{"\[Delta]P1fit", "=", 
               RowBox[{"parametersTable", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1", ",", "3", ",", "3"}], "]"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"P2fit", "=", 
               RowBox[{"parametersTable", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1", ",", "4", ",", "2"}], "]"}], "]"}]}], 
              ";", 
              RowBox[{"\[Delta]P2fit", "=", 
               RowBox[{"parametersTable", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1", ",", "4", ",", "3"}], "]"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"P3fit", "=", 
               RowBox[{"parametersTable", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1", ",", "5", ",", "2"}], "]"}], "]"}]}], 
              ";", 
              RowBox[{"\[Delta]P3fit", "=", 
               RowBox[{"parametersTable", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1", ",", "5", ",", "3"}], "]"}], "]"}]}], 
              ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"P0fit", "=", "0"}], ";", 
              RowBox[{"\[Delta]P0fit", "=", "0"}], ";", "\[IndentingNewLine]", 
              RowBox[{"P1fit", "=", 
               RowBox[{"parametersTable", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}]}], 
              ";", 
              RowBox[{"\[Delta]P1fit", "=", 
               RowBox[{"parametersTable", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1", ",", "2", ",", "3"}], "]"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"P2fit", "=", 
               RowBox[{"parametersTable", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1", ",", "3", ",", "2"}], "]"}], "]"}]}], 
              ";", 
              RowBox[{"\[Delta]P2fit", "=", 
               RowBox[{"parametersTable", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1", ",", "3", ",", "3"}], "]"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"P3fit", "=", 
               RowBox[{"parametersTable", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1", ",", "4", ",", "2"}], "]"}], "]"}]}], 
              ";", 
              RowBox[{"\[Delta]P3fit", "=", 
               RowBox[{"parametersTable", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1", ",", "4", ",", "3"}], "]"}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"FitDataPlot", " ", "=", " ", 
            RowBox[{"Show", "[", 
             RowBox[{"(*", " ", 
              RowBox[{
              "Plotting", " ", "data", " ", "and", " ", "fit", " ", "on", " ",
                "the", " ", "same", " ", "plot"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{"Data", ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
                RowBox[{"Joined", "\[Rule]", "False"}], ",", 
                RowBox[{"PlotLabel", "\[Rule]", 
                 RowBox[{
                 "\"\<Experiment data ERF fitting, \
\!\(\*SuperscriptBox[\(R\), \(2\)]\) = \>\"", "<>", "R2"}]}], ",", 
                RowBox[{"AxesLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<Knife x\>\"", ",", "\"\<Power\>\""}], "}"}]}], 
                ",", 
                RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Plot", "[", 
               RowBox[{
                RowBox[{"PmeasuredErf", "[", 
                 RowBox[{
                 "P0fit", ",", "P1fit", ",", "P2fit", ",", "P3fit", ",", "Px",
                   ",", "Sgn"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Px", ",", 
                  RowBox[{"Min", "[", 
                   RowBox[{"Data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
                  RowBox[{"Max", "[", 
                   RowBox[{"Data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], 
                ",", 
                RowBox[{"ColorFunction", "\[Rule]", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", "Red"}], "]"}]}], 
                ",", 
                RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"exportDir", ",", 
                RowBox[{"\"\<z=\>\"", "<>", 
                 RowBox[{"ToString", "[", "zStep", "]"}], "<>", "\"\<_\>\"", 
                 "<>", "\"\<ERFFitPlot.png\>\""}]}], "}"}], "]"}], ",", 
             "FitDataPlot"}], "]"}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"Exporting", " ", "plot", " ", "from", " ", "above"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"DataFitString", "=", 
            RowBox[{
            "\"\<Data fit ( P0 + P1/2 * (1 \[PlusMinus] \
Erf[Sqrt[2](Px-P2)/P3]) ) :\>\"", "<>", "\"\<\\n\\t\>\"", "<>", 
             RowBox[{"(*", " ", 
              RowBox[{
              "Forming", " ", "string", " ", "with", " ", "all", " ", 
               "parameters", " ", "for", " ", "later", " ", "export"}], " ", 
              "*)"}], "\[IndentingNewLine]", "\"\<P0[Power Noise] = \>\"", "<>", 
             RowBox[{"ToString", "[", "P0fit", "]"}], "<>", 
             "\"\< \[PlusMinus] \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Abs", "[", "\[Delta]P0fit", "]"}], "]"}], "<>", 
             "\"\<, t.m. \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"100", "\[Times]", 
               RowBox[{"Abs", "[", 
                FractionBox["\[Delta]P0fit", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   SuperscriptBox["10", 
                    RowBox[{"-", "7"}]], ",", "P0fit"}], "]"}]], "]"}]}], 
              "]"}], "<>", "\"\< %\>\"", "<>", "\"\<\\n\\t\>\"", "<>", 
             "\[IndentingNewLine]", "\"\<P1[Power] = \>\"", "<>", 
             RowBox[{"ToString", "[", "P1fit", "]"}], "<>", 
             "\"\< \[PlusMinus] \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Abs", "[", "\[Delta]P1fit", "]"}], "]"}], "<>", 
             "\"\<, t.m. \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"100", "\[Times]", 
               RowBox[{"Abs", "[", 
                FractionBox["\[Delta]P1fit", "P1fit"], "]"}]}], "]"}], "<>", 
             "\"\< %\>\"", "<>", "\"\<\\n\\t\>\"", "<>", 
             "\[IndentingNewLine]", "\"\<P2[Beam Center] = \>\"", "<>", 
             RowBox[{"ToString", "[", "P2fit", "]"}], "<>", 
             "\"\< \[PlusMinus] \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Abs", "[", "\[Delta]P2fit", "]"}], "]"}], "<>", 
             "\"\<, t.m. \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"100", "\[Times]", 
               RowBox[{"Abs", "[", 
                FractionBox["\[Delta]P2fit", "P2fit"], "]"}]}], "]"}], "<>", 
             "\"\< %\>\"", "<>", "\"\<\\n\\t\>\"", "<>", 
             "\[IndentingNewLine]", "\"\<P3[Beam Radius E-2] = \>\"", "<>", 
             RowBox[{"ToString", "[", "P3fit", "]"}], "<>", 
             "\"\< \[PlusMinus] \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Abs", "[", "\[Delta]P3fit", "]"}], "]"}], "<>", 
             "\"\<, t.m. \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"100", "\[Times]", 
               RowBox[{"Abs", "[", 
                FractionBox["\[Delta]P3fit", "P3fit"], "]"}]}], "]"}], "<>", 
             "\"\< %\>\""}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"exportDir", ",", 
                RowBox[{"\"\<z=\>\"", "<>", 
                 RowBox[{"ToString", "[", "zStep", "]"}], "<>", "\"\<_\>\"", 
                 "<>", "\"\<ERFFit.txt\>\""}]}], "}"}], "]"}], ",", 
             "DataFitString"}], "]"}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"Exporting", " ", "string", " ", "from", " ", "above"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"BeamERFPlot", "[", 
             RowBox[{"[", "ExperimentRound", "]"}], "]"}], "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"zStep", ",", " ", 
                RowBox[{"2", " ", "P3fit"}]}], "}"}], ",", 
              RowBox[{"ErrorBar", "[", 
               RowBox[{"2", " ", "\[Delta]P3fit"}], "]"}]}], "}"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"Forming", " ", "data", " ", "for", " ", "plotting"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"BeamERFExport", "[", 
             RowBox[{"[", "ExperimentRound", "]"}], "]"}], "=", 
            RowBox[{"{", 
             RowBox[{"zStep", ",", " ", 
              RowBox[{"2", " ", "P3fit"}], ",", 
              RowBox[{"2", " ", "\[Delta]P3fit"}]}], "}"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"Forming", " ", "data", " ", "for", " ", "exporting"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"BeamERFCenterPlot", "[", 
             RowBox[{"[", "ExperimentRound", "]"}], "]"}], "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"zStep", ",", " ", "P2fit"}], "}"}], ",", 
              RowBox[{"ErrorBar", "[", "\[Delta]P2fit", "]"}]}], "}"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"Forming", " ", "data", " ", "for", " ", "plotting"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"BeamERFCenterExport", "[", 
             RowBox[{"[", "ExperimentRound", "]"}], "]"}], "=", 
            RowBox[{"{", 
             RowBox[{"zStep", ",", " ", "P2fit", ",", "\[Delta]P2fit"}], 
             "}"}]}], ";"}]}], 
         RowBox[{"(*", " ", 
          RowBox[{"Forming", " ", "data", " ", "for", " ", "exporting"}], " ",
           "*)"}], "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ExperimentRound", ",", "zStep"}], "}"}]}], "]"}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Monitoring", " ", "current", " ", "round"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"BeamERFPlot", "=", 
       RowBox[{"BeamERFPlot", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Cutting", " ", "first", " ", "fake", " ", "data"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"BeamERFExport", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{"\"\<R\>\"", ",", "\"\<W\>\"", ",", "\"\<dW\>\""}], "}"}]}], 
      ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Adding", " ", "column", " ", "names"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"exportDir", ",", "\"\<BeamERF.xlsx\>\""}], "}"}], "]"}], 
        ",", "BeamERFExport"}], "]"}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Exporting", " ", "data", " ", "from", " ", "above"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"BeamERFCenterPlot", "=", 
       RowBox[{"BeamERFCenterPlot", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Cutting", " ", "first", " ", "fake", " ", "data"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"BeamERFCenterExport", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{"\"\<R\>\"", ",", "\"\<Xc\>\"", ",", "\"\<dXc\>\""}], "}"}]}],
       ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Adding", " ", "column", " ", "names"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"exportDir", ",", "\"\<BeamERFCenter.xlsx\>\""}], "}"}], 
         "]"}], ",", "BeamERFCenterExport"}], "]"}], ";"}], 
     RowBox[{"(*", " ", 
      RowBox[{"Exporting", " ", "data", " ", "from", " ", "above"}], " ", 
      "*)"}], "\[IndentingNewLine]", ")"}]}], ";"}]}]], "Input",
 CellChangeTimes->{
  3.697359480387085*^9, {3.6973595147774224`*^9, 3.697359962158517*^9}, {
   3.697360021949829*^9, 3.697360048948936*^9}, {3.6973601466641397`*^9, 
   3.6973601500445423`*^9}, 3.6973602837431593`*^9, 3.6973641201754713`*^9, {
   3.697364346206958*^9, 3.6973643921028595`*^9}, {3.69736449873477*^9, 
   3.697364505503371*^9}, {3.6973650613486624`*^9, 3.697365209589094*^9}, {
   3.6973652973013954`*^9, 3.6973653706334667`*^9}, {3.697365641378936*^9, 
   3.6973656766777573`*^9}, 3.697365780252036*^9, 3.697365838951087*^9, {
   3.6973658786069045`*^9, 3.697365919812499*^9}, {3.6973660305317764`*^9, 
   3.69736603108856*^9}, {3.697366244331452*^9, 3.6973662633546576`*^9}, {
   3.697366314226137*^9, 3.6973663145230107`*^9}, {3.6973664479674387`*^9, 
   3.6973664802601995`*^9}, {3.697366589742157*^9, 3.697366637996293*^9}, {
   3.6973666758223743`*^9, 3.6973667135451927`*^9}, {3.697366749207148*^9, 
   3.6973667674501333`*^9}, 3.6973673399693584`*^9, {3.6973678182395477`*^9, 
   3.697367818569206*^9}, {3.697442855879549*^9, 3.6974428657233987`*^9}, 
   3.6974432376533403`*^9, 3.6974433124131365`*^9, {3.697444061682932*^9, 
   3.697444073917094*^9}, {3.697444285643808*^9, 3.697444364606759*^9}, {
   3.697444515507389*^9, 3.697444550494114*^9}, {3.6974445926397686`*^9, 
   3.6974446082783337`*^9}, {3.6974446431642146`*^9, 
   3.6974446478793635`*^9}, {3.69744483900559*^9, 3.697444843926098*^9}, {
   3.697444877161126*^9, 3.6974448798382607`*^9}, {3.69744491443275*^9, 
   3.697444919394888*^9}, {3.697444957137205*^9, 3.69744512177976*^9}, {
   3.6974455256429887`*^9, 3.697445568518015*^9}, 3.697454069119114*^9, {
   3.6974547609227667`*^9, 3.6974547612189565`*^9}, {3.6974549963002405`*^9, 
   3.6974549974307995`*^9}, {3.697455500003189*^9, 3.6974555582441597`*^9}, {
   3.6974598230696974`*^9, 3.697459851754119*^9}, {3.697460005778787*^9, 
   3.697460015109769*^9}, {3.697463629705676*^9, 3.6974636330479383`*^9}, {
   3.6974637899547024`*^9, 3.6974637920527096`*^9}, {3.697464072852721*^9, 
   3.6974641381442175`*^9}, 3.6974644842240267`*^9, {3.6974645955163918`*^9, 
   3.697464603599122*^9}, 3.6974649357953367`*^9, {3.697465617147178*^9, 
   3.6974656431646004`*^9}, {3.697598170865755*^9, 3.6975981925847282`*^9}, {
   3.697598538418857*^9, 3.6975985447314205`*^9}, {3.697599047396673*^9, 
   3.697599056173885*^9}, {3.6978672243747807`*^9, 3.697867288764434*^9}, {
   3.697867525385976*^9, 3.69786760949922*^9}, {3.6978728390406513`*^9, 
   3.697872839259389*^9}, {3.6982042570017014`*^9, 3.698204292152213*^9}, {
   3.698208416113177*^9, 3.6982084172169476`*^9}, {3.698208618646521*^9, 
   3.6982086187525854`*^9}, {3.6982097484412255`*^9, 
   3.6982097733939037`*^9}, {3.6982098375826073`*^9, 
   3.6982098403275366`*^9}, {3.698213011803051*^9, 3.6982130401861677`*^9}, {
   3.698383942806785*^9, 3.698383968667133*^9}, {3.6983840481768074`*^9, 
   3.6983841584009943`*^9}, {3.6983842015797462`*^9, 
   3.6983842032516365`*^9}, {3.6983842406637096`*^9, 3.698384249636552*^9}, {
   3.69838430487598*^9, 3.69838440322215*^9}, {3.6983844383433075`*^9, 
   3.6983845100960426`*^9}, {3.6983846324255342`*^9, 
   3.6983847152615104`*^9}, {3.698384759886677*^9, 3.698384780072112*^9}, {
   3.6983848398592386`*^9, 3.698384849730497*^9}, {3.6983849079515057`*^9, 
   3.6983849446922274`*^9}, {3.6983849960838647`*^9, 
   3.6983850385069494`*^9}, {3.6983850724038305`*^9, 3.6983850978754296`*^9}, 
   3.698385329338765*^9, {3.6983853817669735`*^9, 3.6983853881050034`*^9}, {
   3.698390593217823*^9, 3.698390606161977*^9}, {3.6985660350869627`*^9, 
   3.698566041401433*^9}, {3.69863264718285*^9, 3.698632658801115*^9}, {
   3.7086849859145365`*^9, 3.7086850039923835`*^9}, 3.709044300417217*^9, {
   3.709382750963341*^9, 3.7093827513193655`*^9}, {3.7093827834163103`*^9, 
   3.709382799573431*^9}, {3.7093828357118*^9, 3.7093828641173544`*^9}, {
   3.709382921500671*^9, 3.709382959469404*^9}, {3.7099563969319696`*^9, 
   3.709956418562828*^9}, {3.7100797866692753`*^9, 3.7100797881973844`*^9}, {
   3.710079975606385*^9, 3.7100799922646255`*^9}, {3.710080076326404*^9, 
   3.710080076670431*^9}, {3.7100807551148305`*^9, 3.7100807690287256`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Calculating", " ", "beam", " ", "profile", " ", "fitting", " ", "with", 
    " ", "Gauss"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CalculateGauss", "[", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"ExperimentRound", "=", "1"}], ",", 
          RowBox[{"ExperimentRound", "<", "Experiments"}], ",", 
          RowBox[{
           RowBox[{"ExperimentRound", "+=", "1"}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"For", " ", "all", " ", "experiments", " ", 
             RowBox[{"(", 
              RowBox[{
              "all", " ", "lists", " ", "in", " ", "Exel", " ", "file"}], 
              ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"zStep", "=", 
            RowBox[{"AllData", "[", 
             RowBox[{"[", 
              RowBox[{"ExperimentRound", ",", "1", ",", "1"}], "]"}], "]"}]}],
            ";", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Z", " ", "coordinate", " ", "for", " ", "current", " ", 
             "experiment"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Data", "=", 
            RowBox[{"MyDerivative", "[", 
             RowBox[{"AllData", "[", 
              RowBox[{"[", 
               RowBox[{"ExperimentRound", ",", 
                RowBox[{"3", ";;"}], ",", 
                RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"Getting", " ", "round", " ", "data"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"UsePowerNoise", ",", 
             RowBox[{"PowerNoise", "=", 
              RowBox[{"Min", "[", 
               RowBox[{"Data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"PowerNoise", "=", "0"}]}], "]"}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "If", " ", "we", " ", "need", " ", "power", " ", "noize", " ", 
              "fitting"}], ",", " ", 
             RowBox[{
             "it", " ", "is", " ", "Min", " ", "from", " ", "all", " ", 
              "Data"}], ",", " ", 
             RowBox[{"otherwise", " ", "-", " ", "0"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"BeamPower", "=", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"Data", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "-", 
             "PowerNoise"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{
            "All", " ", "beam", " ", "power", " ", "is", " ", "Max", " ", 
             "minus", " ", "power", " ", "noize"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"BeamRadius", "=", 
            FractionBox[
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"Data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "-", 
              RowBox[{"Min", "[", 
               RowBox[{"Data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "2"]}], 
           ";", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Beam", " ", "radius", " ", "must", " ", "be", " ", "less", " ", 
             "then", " ", "half", " ", "of", " ", "data", " ", "range"}], " ",
             "*)"}], "\[IndentingNewLine]", 
           RowBox[{"nlm", "=", 
            RowBox[{"NonlinearModelFit", "[", 
             RowBox[{"Data", ",", 
              RowBox[{"GaussFunction", "[", 
               RowBox[{"y0", ",", "A", ",", "xc", ",", "\[Sigma]", ",", "x"}],
                "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"y0", ",", "PowerNoise"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"A", ",", "BeamPower"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"xc", ",", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"Data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "+", 
                    RowBox[{"Max", "[", 
                    RowBox[{"Data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "2"]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Sigma]", ",", 
                  FractionBox["BeamRadius", "3"]}], "}"}]}], "}"}], ",", 
              "x"}], "]"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"Fitting", " ", "with", " ", "noize"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"parametersTable", " ", "=", " ", 
            RowBox[{"nlm", "[", "\"\<ParameterTable\>\"", "]"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"Getting", " ", "fitted", " ", "parameters"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NumericQ", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"nlm", "[", "\"\<RSquared\>\"", "]"}], "]"}], "]"}], 
             ",", 
             RowBox[{"R2", "=", 
              RowBox[{"ToString", "[", 
               RowBox[{"nlm", "[", "\"\<RSquared\>\"", "]"}], "]"}]}], ",", 
             RowBox[{"R2", "=", "\"\<UNDEFINED\>\""}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"y0Fit", "=", 
            RowBox[{"parametersTable", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}]}], 
           ";", 
           RowBox[{"\[Delta]y0Fit", "=", 
            RowBox[{"parametersTable", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1", ",", "2", ",", "3"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"AFit", "=", 
            RowBox[{"parametersTable", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1", ",", "3", ",", "2"}], "]"}], "]"}]}], 
           ";", 
           RowBox[{"\[Delta]AFit", "=", 
            RowBox[{"parametersTable", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1", ",", "3", ",", "3"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"xcFit", "=", 
            RowBox[{"parametersTable", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1", ",", "4", ",", "2"}], "]"}], "]"}]}], 
           ";", 
           RowBox[{"\[Delta]xcFit", "=", 
            RowBox[{"parametersTable", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1", ",", "4", ",", "3"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"\[Sigma]Fit", "=", 
            RowBox[{"Abs", "[", 
             RowBox[{"parametersTable", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1", ",", "5", ",", "2"}], "]"}], "]"}], 
             "]"}]}], ";", 
           RowBox[{"\[Delta]\[Sigma]Fit", "=", 
            RowBox[{"parametersTable", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1", ",", "5", ",", "3"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"FitDataPlot", " ", "=", " ", 
            RowBox[{"Show", "[", 
             RowBox[{"(*", " ", 
              RowBox[{
              "Plotting", " ", "data", " ", "and", " ", "fit", " ", "on", " ",
                "the", " ", "same", " ", "plot"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{"Data", ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
                RowBox[{"Joined", "\[Rule]", "False"}], ",", 
                RowBox[{"PlotLabel", "\[Rule]", 
                 RowBox[{
                 "\"\<First devariative fitting with Gauss fitting, \
\!\(\*SuperscriptBox[\(R\), \(2\)]\) = \>\"", "<>", "R2"}]}], ",", 
                RowBox[{"AxesLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<Knife x\>\"", ",", "\"\<Power\>\""}], "}"}]}], 
                ",", 
                RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Plot", "[", 
               RowBox[{
                RowBox[{"GaussFunction", "[", 
                 RowBox[{
                 "y0Fit", ",", "AFit", ",", "xcFit", ",", "\[Sigma]Fit", ",", 
                  "x"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{"Min", "[", 
                   RowBox[{"Data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
                  RowBox[{"Max", "[", 
                   RowBox[{"Data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], 
                ",", 
                RowBox[{"ColorFunction", "\[Rule]", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", "Red"}], "]"}]}], 
                ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"exportDir", ",", 
                RowBox[{"\"\<z=\>\"", "<>", 
                 RowBox[{"ToString", "[", "zStep", "]"}], "<>", "\"\<_\>\"", 
                 "<>", "\"\<GaussFitPlot.png\>\""}]}], "}"}], "]"}], ",", 
             "FitDataPlot"}], "]"}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"Exporting", " ", "plot", " ", "from", " ", "above"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"DataFitString", "=", 
            RowBox[{
            "\"\<Data fit ( y0 + A Exp[-(x-xc)^2/(2\[Sigma]^2)] ) :\>\"", 
             "<>", "\"\<\\n\\t\>\"", "<>", 
             RowBox[{"(*", " ", 
              RowBox[{
              "Forming", " ", "string", " ", "with", " ", "all", " ", 
               "parameters", " ", "for", " ", "later", " ", "export"}], " ", 
              "*)"}], "\[IndentingNewLine]", "\"\<y0[Power Noise] = \>\"", "<>", 
             RowBox[{"ToString", "[", "y0Fit", "]"}], "<>", 
             "\"\< \[PlusMinus] \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Abs", "[", "\[Delta]y0Fit", "]"}], "]"}], "<>", 
             "\"\<, t.m. \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"100", "\[Times]", 
               RowBox[{"Abs", "[", 
                FractionBox["\[Delta]y0Fit", "y0Fit"], "]"}]}], "]"}], "<>", 
             "\"\< %\>\"", "<>", "\"\<\\n\\t\>\"", "<>", 
             "\[IndentingNewLine]", "\"\<A[] = \>\"", "<>", 
             RowBox[{"ToString", "[", "AFit", "]"}], "<>", 
             "\"\< \[PlusMinus] \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Abs", "[", "\[Delta]AFit", "]"}], "]"}], "<>", 
             "\"\<, t.m. \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"100", "\[Times]", 
               RowBox[{"Abs", "[", 
                FractionBox["\[Delta]AFit", "AFit"], "]"}]}], "]"}], "<>", 
             "\"\< %\>\"", "<>", "\"\<\\n\\t\>\"", "<>", 
             "\[IndentingNewLine]", "\"\<xc[Beam Center] = \>\"", "<>", 
             RowBox[{"ToString", "[", "xcFit", "]"}], "<>", 
             "\"\< \[PlusMinus] \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Abs", "[", "\[Delta]xcFit", "]"}], "]"}], "<>", 
             "\"\<, t.m. \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"100", "\[Times]", 
               RowBox[{"Abs", "[", 
                FractionBox["\[Delta]xcFit", "xcFit"], "]"}]}], "]"}], "<>", 
             "\"\< %\>\"", "<>", "\"\<\\n\\t\>\"", "<>", 
             "\[IndentingNewLine]", 
             "\"\<\[Sigma][2\[Sigma] = Beam Radius E-2] = \>\"", "<>", 
             RowBox[{"ToString", "[", "\[Sigma]Fit", "]"}], "<>", 
             "\"\< \[PlusMinus] \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Abs", "[", "\[Delta]\[Sigma]Fit", "]"}], "]"}], "<>", 
             "\"\<, t.m. \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"100", "\[Times]", 
               RowBox[{"Abs", "[", 
                FractionBox["\[Delta]\[Sigma]Fit", "\[Sigma]Fit"], "]"}]}], 
              "]"}], "<>", "\"\< %\>\""}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"exportDir", ",", 
                RowBox[{"\"\<z=\>\"", "<>", 
                 RowBox[{"ToString", "[", "zStep", "]"}], "<>", "\"\<_\>\"", 
                 "<>", "\"\<GaussFit.txt\>\""}]}], "}"}], "]"}], ",", 
             "DataFitString"}], "]"}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"Exporting", " ", "string", " ", "from", " ", "above"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"BeamGaussPlot", "[", 
             RowBox[{"[", "ExperimentRound", "]"}], "]"}], "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"zStep", ",", " ", 
                RowBox[{"4", " ", "\[Sigma]Fit"}]}], "}"}], ",", 
              RowBox[{"ErrorBar", "[", 
               RowBox[{"4", " ", "\[Delta]\[Sigma]Fit"}], "]"}]}], "}"}]}], 
           ";", 
           RowBox[{"(*", " ", 
            RowBox[{"Getting", " ", "data", " ", "for", " ", "plotting"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"BeamGaussExport", "[", 
             RowBox[{"[", "ExperimentRound", "]"}], "]"}], "=", 
            RowBox[{"{", 
             RowBox[{"zStep", ",", " ", 
              RowBox[{"4", " ", "\[Sigma]Fit"}], ",", 
              RowBox[{"4", " ", "\[Delta]\[Sigma]Fit"}]}], "}"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"Getting", " ", "data", " ", "for", " ", "exporting"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"BeamGaussCenterPlot", "[", 
             RowBox[{"[", "ExperimentRound", "]"}], "]"}], "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"zStep", ",", " ", "xcFit"}], "}"}], ",", 
              RowBox[{"ErrorBar", "[", "\[Delta]xcFit", "]"}]}], "}"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"Getting", " ", "data", " ", "for", " ", "plotting"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"BeamGaussCenterExport", "[", 
             RowBox[{"[", "ExperimentRound", "]"}], "]"}], "=", 
            RowBox[{"{", 
             RowBox[{"zStep", ",", " ", "xcFit", ",", "\[Delta]xcFit"}], 
             "}"}]}], ";"}]}], 
         RowBox[{"(*", " ", 
          RowBox[{"Getting", " ", "data", " ", "for", " ", "exporting"}], " ",
           "*)"}], "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ExperimentRound", ",", "zStep"}], "}"}]}], "]"}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Monitoring", " ", "current", " ", "round"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"BeamGaussPlot", "=", 
       RowBox[{"BeamGaussPlot", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Cutting", " ", "first", " ", "fake", " ", "data"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"BeamGaussExport", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{"\"\<R\>\"", ",", "\"\<W\>\"", ",", "\"\<dW\>\""}], "}"}]}], 
      ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Adding", " ", "column", " ", "names"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"exportDir", ",", "\"\<BeamGauss.xlsx\>\""}], "}"}], "]"}], 
        ",", "BeamGaussExport"}], "]"}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Exporting", " ", "data", " ", "from", " ", "above"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"BeamGaussCenterPlot", "=", 
       RowBox[{"BeamGaussCenterPlot", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Cutting", " ", "first", " ", "fake", " ", "data"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"BeamGaussCenterExport", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{"\"\<R\>\"", ",", "\"\<Xc\>\"", ",", "\"\<dXc\>\""}], "}"}]}],
       ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Adding", " ", "column", " ", "names"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"exportDir", ",", "\"\<BeamGaussCenter.xlsx\>\""}], "}"}], 
         "]"}], ",", "BeamGaussCenterExport"}], "]"}], ";"}], 
     RowBox[{"(*", " ", 
      RowBox[{"Exporting", " ", "data", " ", "from", " ", "above"}], " ", 
      "*)"}], "\[IndentingNewLine]", ")"}]}], ";"}]}]], "Input",
 CellChangeTimes->{
  3.697359480387085*^9, {3.6973595147774224`*^9, 3.697359962158517*^9}, {
   3.697360021949829*^9, 3.697360048948936*^9}, {3.6973601466641397`*^9, 
   3.6973601500445423`*^9}, 3.6973602837431593`*^9, 3.6973641201754713`*^9, {
   3.697364346206958*^9, 3.6973643921028595`*^9}, {3.69736449873477*^9, 
   3.697364505503371*^9}, {3.6973650613486624`*^9, 3.697365209589094*^9}, {
   3.6973652973013954`*^9, 3.6973653706334667`*^9}, {3.697365641378936*^9, 
   3.6973656766777573`*^9}, 3.697365780252036*^9, 3.697365838951087*^9, {
   3.6973658786069045`*^9, 3.697365919812499*^9}, {3.6973660305317764`*^9, 
   3.69736603108856*^9}, {3.697366244331452*^9, 3.6973662633546576`*^9}, {
   3.697366314226137*^9, 3.6973663145230107`*^9}, {3.6973664479674387`*^9, 
   3.6973664802601995`*^9}, {3.697366589742157*^9, 3.697366637996293*^9}, {
   3.6973666758223743`*^9, 3.6973667135451927`*^9}, {3.697366749207148*^9, 
   3.6973667674501333`*^9}, 3.6973673399693584`*^9, {3.6973678182395477`*^9, 
   3.697367818569206*^9}, {3.697442855879549*^9, 3.6974428657233987`*^9}, 
   3.6974432376533403`*^9, 3.6974433124131365`*^9, {3.697444061682932*^9, 
   3.697444073917094*^9}, {3.697444285643808*^9, 3.697444364606759*^9}, {
   3.697444515507389*^9, 3.697444550494114*^9}, {3.6974445926397686`*^9, 
   3.6974446082783337`*^9}, {3.6974446431642146`*^9, 
   3.6974446478793635`*^9}, {3.69744483900559*^9, 3.697444843926098*^9}, {
   3.697444877161126*^9, 3.6974448798382607`*^9}, {3.69744491443275*^9, 
   3.697444919394888*^9}, {3.697444957137205*^9, 3.69744512177976*^9}, {
   3.6974455256429887`*^9, 3.697445568518015*^9}, 3.697454069119114*^9, {
   3.6974547609227667`*^9, 3.6974547612189565`*^9}, {3.6974549963002405`*^9, 
   3.6974549974307995`*^9}, {3.697455500003189*^9, 3.6974555582441597`*^9}, {
   3.6974598230696974`*^9, 3.697459851754119*^9}, {3.697460005778787*^9, 
   3.697460015109769*^9}, {3.697463656896823*^9, 3.6974636744636297`*^9}, {
   3.6974638039017096`*^9, 3.697464051984391*^9}, {3.697464387682693*^9, 
   3.6974644772460766`*^9}, {3.697464519585039*^9, 3.697464559911194*^9}, {
   3.69746483853613*^9, 3.697464850034277*^9}, 3.6974649294088273`*^9, {
   3.6974653693625617`*^9, 3.6974654151569695`*^9}, 3.6974657339398317`*^9, {
   3.697465799097539*^9, 3.697465799218624*^9}, {3.6974680607345295`*^9, 
   3.6974680637016296`*^9}, {3.697598511465454*^9, 3.697598551934621*^9}, 
   3.6975991881910057`*^9, {3.6978676218180356`*^9, 3.697867670286745*^9}, {
   3.69805078744561*^9, 3.698050790574872*^9}, 3.698074438539074*^9, {
   3.698208425808689*^9, 3.6982084260138345`*^9}, 3.698208646990448*^9, {
   3.698209789736824*^9, 3.6982098264101286`*^9}, {3.698213053073925*^9, 
   3.6982130622312183`*^9}, 3.6983839773426723`*^9, 3.698384117346695*^9, {
   3.6983851072768116`*^9, 3.6983851548116927`*^9}, {3.698385186265942*^9, 
   3.698385361853018*^9}, {3.6983854296888447`*^9, 3.6983854431818457`*^9}, 
   3.698390618278536*^9, {3.698566043885187*^9, 3.698566048743246*^9}, {
   3.6986327010393353`*^9, 3.698632701758091*^9}, {3.6986703130574656`*^9, 
   3.6986703131824665`*^9}, {3.7086848047239547`*^9, 3.708684823055352*^9}, {
   3.7088713922247014`*^9, 3.708871407579446*^9}, {3.708871610602454*^9, 
   3.7088716116742125`*^9}, {3.7088716994733744`*^9, 3.708871699582461*^9}, {
   3.7093829903798275`*^9, 3.709383095151727*^9}, {3.7093832534741917`*^9, 
   3.7093832629907417`*^9}, {3.709956426019413*^9, 3.709956428019429*^9}, {
   3.710079800941117*^9, 3.710079802157202*^9}, 3.71008009494374*^9, {
   3.7100807820725546`*^9, 3.7100807879147873`*^9}, {3.715496046448679*^9, 
   3.7154960483820567`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CalculateERF", "[", "]"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Calculating", " ", "beam", " ", "diameter", " ", "with", " ", "Gauss", 
    " ", "function"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BeamERFExport", "//", "TableForm"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Showing", " ", "calculated", " ", "data", " ", "in", " ", "a", " ", 
    "table"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Experiments", "\[GreaterEqual]", "4"}], ",", 
    RowBox[{"GetBeamPropogationFit", "[", 
     RowBox[{"BeamERFPlot", ",", "\"\<ERF\>\""}], "]"}], " ", ",", 
    "\"\<Not enough measured points for waist calculation \>\""}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Beam", " ", "parameters", " ", "calculating"}], " ", 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6974657537258334`*^9, 3.697465783313773*^9}, 
   3.6974679828038445`*^9, {3.697468182462687*^9, 3.697468182910993*^9}, {
   3.69786769848647*^9, 3.6978677068641214`*^9}, 3.6980493641417027`*^9, 
   3.6980494189393578`*^9, {3.6980502645246763`*^9, 3.698050272806157*^9}, {
   3.6982046770037518`*^9, 3.6982046791742735`*^9}, {3.6982047820639877`*^9, 
   3.698204806928952*^9}, {3.698206939893152*^9, 3.698206966552921*^9}, 
   3.6982078672871847`*^9, {3.6982079596801233`*^9, 3.6982079851309385`*^9}, {
   3.6982084850528717`*^9, 3.69820850710679*^9}, {3.6982139667310286`*^9, 
   3.698213989556279*^9}, 3.6982142982280893`*^9, {3.6983856871898756`*^9, 
   3.698385687377365*^9}, {3.709477984653758*^9, 3.709477985132098*^9}, 
   3.7095210533957167`*^9, 3.7095210942756696`*^9, {3.709521186337902*^9, 
   3.709521260293627*^9}, {3.709952672158843*^9, 3.709952672767226*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"R\"\>", "\<\"W\"\>", "\<\"dW\"\>"},
    {
     RowBox[{"-", "5.`"}], "209.67606661226708`", "11.02022706502709`"},
    {
     RowBox[{"-", "4.`"}], "187.03253685478094`", "2.9619668947393265`"},
    {
     RowBox[{"-", "3.`"}], "155.0897916493461`", "1.5073513901775126`"},
    {"0.`", "52.15192585800813`", "1.3946595863066242`"},
    {"3.`", "105.93482327569016`", "1.4189522585205236`"},
    {"4.`", "134.65690803525865`", "0.8945463730788591`"},
    {"5.`", "161.31907068853198`", "1.2451658397633292`"},
    {"6.`", "199.72381652222393`", "1.4359199053882064`"},
    {"7.`", "229.7178192441167`", "4.860601797346847`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7222425389518986`*^9}],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      PointBox[{{-5., 209.67606661226708`}, {-4., 187.03253685478094`}, {-3., 
       155.0897916493461}, {0., 52.15192585800813}, {3., 
       105.93482327569016`}, {4., 134.65690803525865`}, {5., 
       161.31907068853198`}, {6., 199.72381652222393`}, {7., 
       229.7178192441167}}], {{
        LineBox[{{-5., 220.69629367729416`}, {-5., 198.65583954724}}], 
        LineBox[{
         Offset[{1.5, 0}, {-5., 220.69629367729416`}], 
          Offset[{-1.5, 0}, {-5., 220.69629367729416`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {-5., 198.65583954724}], 
          Offset[{-1.5, 0}, {-5., 198.65583954724}]}]}, {
        LineBox[{{-4., 189.99450374952028`}, {-4., 184.0705699600416}}], 
        LineBox[{
         Offset[{1.5, 0}, {-4., 189.99450374952028`}], 
          Offset[{-1.5, 0}, {-4., 189.99450374952028`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {-4., 184.0705699600416}], 
          Offset[{-1.5, 0}, {-4., 184.0705699600416}]}]}, {
        LineBox[{{-3., 156.59714303952362`}, {-3., 153.58244025916858`}}], 
        LineBox[{
         Offset[{1.5, 0}, {-3., 156.59714303952362`}], 
          Offset[{-1.5, 0}, {-3., 156.59714303952362`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {-3., 153.58244025916858`}], 
          Offset[{-1.5, 0}, {-3., 153.58244025916858`}]}]}, {
        LineBox[{{0., 53.54658544431475}, {0., 50.7572662717015}}], 
        LineBox[{
         Offset[{1.5, 0}, {0., 53.54658544431475}], 
          Offset[{-1.5, 0}, {0., 53.54658544431475}]}], 
        LineBox[{
         Offset[{1.5, 0}, {0., 50.7572662717015}], 
          Offset[{-1.5, 0}, {0., 50.7572662717015}]}]}, {
        LineBox[{{3., 107.35377553421068`}, {3., 104.51587101716964`}}], 
        LineBox[{
         Offset[{1.5, 0}, {3., 107.35377553421068`}], 
          Offset[{-1.5, 0}, {3., 107.35377553421068`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {3., 104.51587101716964`}], 
          Offset[{-1.5, 0}, {3., 104.51587101716964`}]}]}, {
        LineBox[{{4., 135.55145440833752`}, {4., 133.76236166217979`}}], 
        LineBox[{
         Offset[{1.5, 0}, {4., 135.55145440833752`}], 
          Offset[{-1.5, 0}, {4., 135.55145440833752`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {4., 133.76236166217979`}], 
          Offset[{-1.5, 0}, {4., 133.76236166217979`}]}]}, {
        LineBox[{{5., 162.5642365282953}, {5., 160.07390484876865`}}], 
        LineBox[{
         Offset[{1.5, 0}, {5., 162.5642365282953}], 
          Offset[{-1.5, 0}, {5., 162.5642365282953}]}], 
        LineBox[{
         Offset[{1.5, 0}, {5., 160.07390484876865`}], 
          Offset[{-1.5, 0}, {5., 160.07390484876865`}]}]}, {
        LineBox[{{6., 201.15973642761213`}, {6., 198.28789661683572`}}], 
        LineBox[{
         Offset[{1.5, 0}, {6., 201.15973642761213`}], 
          Offset[{-1.5, 0}, {6., 201.15973642761213`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {6., 198.28789661683572`}], 
          Offset[{-1.5, 0}, {6., 198.28789661683572`}]}]}, {
        LineBox[{{7., 234.57842104146354`}, {7., 224.85721744676985`}}], 
        LineBox[{
         Offset[{1.5, 0}, {7., 234.57842104146354`}], 
          Offset[{-1.5, 0}, {7., 234.57842104146354`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {7., 224.85721744676985`}], 
          Offset[{-1.5, 0}, {7., 
           224.85721744676985`}]}]}}}, {}}, {}, {}, {{}, {}}}, {
    GraphicsComplexBox[CompressedData["
1:eJwVlHk4VA0DxYUo5DPDWJKSQn2WpEWluieExtjJEhFDgytaZMkraZFWtNMq
EtJg7Nu9abHElKVSveohSqGoEFk+3x/nOf+e5zy/cxb7hDj4iYqIiMTN6P/u
y0+onpqWp0WUH+4NZgRBvaGNmb/kLSX8d9W3fV/sMDb55oUnj4nKTmdx1zc+
CJ5fcEHspAbeuC1uuVi9H6ki/WazcnVwQ5Il7q8Ygx16k7WrGw3hXOnYHvHw
GKJYWtJ6wUZQMJtXMv4rAYlG61Pd927EsunkhIac84hbJOYiywe2/Dg30ZKe
jKexG0IYf02w/33oUJrpJYhNf9bjR2wFnzSg9VWvosGd+/f7cwuI3D2x5FBN
CpC1WSpSno2tpqbDUR43kK9wjrpxhoNq1qw3yUq3keP58Cj3vQ3W3lkUTPHu
4GXn4tGuXDvIuYbSxOs0aMiqNq3rtceH8z8OK2xKx/qs6GyveY6wiY1gVZ3O
QFOL8ntHKycMZN/QKx25B60gNXmVA84wyvGRObHtPiaTPG7mFG1HapFA7V5p
FnQM2WzfIRdMtTc6KS/OwcIttyf7lNzQNNVh67H3Ac59MBA3cXEHEe1q+LMj
F4+/LWcGHNmBwT1eEW6GfNiGNqMowwPH5U7JzkUe3I4JaoRdnvjaUmIqO5wH
bckpqzIpLwyUyI/+vZGP9We2XCzV9Ea7pEUC07kAp+3fM7Ufe0NkWXRu8xwB
CJvlrCnnXeAv1NKPzBPAMFnhkfHwLpzVVzu5zb8Q8fMKBzsTfCBzTcNAVK4I
J59m56Wo+kK8/xXHt7gItU82zy8v88VxRWsMBBYj4O8JSRNrLoIS1oZ6yZeA
HUneNBjg4rdg6uB4fQnO6EuUxcf5YXrBvIJ/DpQiSn3Ud0jBHznzZByzVMuQ
6Xa89JHAHwMeaJh8WQajhtrEcYvd8HZYE7QhqhwScZnMlN7dMxx1d91aWYHY
gx+Wck7wcDc+qSK3pwIeafXl/ioBCOv5WnT3bCXCWQ7jX0oDsLdFMr7GtArD
1LmqZutA1JvPOVg/UIVFmRoM4cdA6Gn6VkdcrMbJV46yK2OCkBTf0GG3jYKD
8frzEwwSEzLdLMZPCkOnxLf/KSbxp0/66ToXGrMnil+sT55NHzV2VXzK2AWX
/OxqjdciGOoXLq0xdkCgys1DhpWquN4brqclEwyNTzf3RXFJtNSaZqovo+Gv
53dPtV6WFsv00p0j6g8tg9vr3Hz7iHWmeTd1atgokK7QtGQq4R6L07ujZzc2
/Kc/1tiYxGzrvqsX5Whsu8T4yS/+Q42wdw+rN7oifbveipBWKRSOHLHIsNsB
qRJ7btlZEtPtY0UPCBrSSz5YmhcwaKUsBaU58TzoXg7aOetuE+FcpnuGZc7B
62P14w5VCqhqvnBP090P5hnMOde1SPy935UkFKfh/Mmru25EhM6bFVLmutMT
U2L9I3Vts/FPqqmgJ247FK0j+lQiSagZXXj4eRUN76oWmbGHo8QK6xIdx05r
NNc+W3t9+julczq+Z/qcE6bUdTpc00gYHAqv2mdFw+ir4KjGWyb9Zc23Y5nP
A6AwtanWO72QetHdvt7irg14j+z82pPlcTzYm3FYiQvOYIYVZwGJsPvCBW8m
KeSGSLsfMROjVzzQs5+o8EK2+/N3Yc5i8Igpr/lh6YQFV6VXNOwhMX6pN1tM
n0Z5YFKbQ95PYrU8O2h/nRWuRZdLEKq/KW+GhvK7W9shTlarz71KQr+pqOz8
Vhrtp9TqZPw7ib0qtb49A2xIyilsvZU7QRhqP32sR9oh9LKyd3ldD6WsKQwQ
pDngz6sr1+4/INH+7+ZHzvY0rBsX3kkk5emsy6qOvD2ByNiWblbPEVJxv80K
djLskOd1cX7qJBMTls0f5cN98eJSSPBSJRIa7S4qv0cpvF3TedEzSJz+vMMC
TuEzO5ao4DSyRLHyN9up1dgRtza9sksLILH4AGs5U2eGr0ehpdMGg4SVcraf
hboVhub4R4/yRighlRMgIXBBPOOkSWcyiQjVN0Y3TWj4hpYuahK2EyqilTnb
Dlqh0P/XMo7+OBH1MCbrspkt1PkhVjrcb9SYxf7GyxcccejQrorYTBK/wtwJ
rg0NjSuN4y/tBISIWccpDxdrzFMoGMxYMUxIP0lISSni4HDHThEB9zPxLLnx
7op8NtzLVu/6qTtN9KbWNE6z7XHAQBj+Mp+EKn+pqYXTTN+b2vgWxfK0z3yP
e11UICLDL7yT0myjunid482RdmjTXxs2UcBE61j+74XavkjkOcUkKpAQJt24
IjpM4Ycyp+D5lDhdF3t0Q9ATbzx4X3B8NGwW4mQ+E5LlDvCWK98lu5uEcYgu
79pyGpFvaacHXQOE/arZyaVf2FB7YVzSen6U+ufV1YKuza6w7CYdrRNJWHJ6
D2puoVGpFv5F62UrcUA7vuLaKytIMT+lpH3/Qzh+rEwMO2ODCGPVR5/y+6kM
E5k/TDknbLQxb+xPJyHynBfTx6GhHqJYO7HOj5JeWKodMmINLnXHZ+LHL6Jy
g0RU3VoOdFdv7vbq+UR8ik+N6nnKRh53aavlwCQR4WLa99+3dlgrJji5kU8i
5erKOKEDDdf0xW3Rtk+o4uZnrFmetpBTPGKeFTpEFDcaRvsEzeR7POayv6mD
uD06oflumRU+DPYOFGY8Jr7NtXr26xkHxbyaGNuQEWJ78poweTNrtJw4vECi
u5cIs+2sHeTP/JHnV39uIQkTdWVx2pnG/wAcrM+6
     "], {{}, {}, 
      {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
       Opacity[1.], 
       LineBox[{1, 105, 86, 72, 62, 55, 51, 109, 90, 76, 66, 59, 113, 94, 80, 
        70, 117, 98, 84, 2, 106, 87, 124, 73, 119, 100, 127, 63, 115, 96, 126,
         82, 121, 102, 129, 56, 112, 93, 125, 79, 120, 101, 128, 69, 116, 97, 
        83, 122, 103, 52, 110, 91, 77, 67, 60, 3, 107, 88, 74, 64, 57, 53, 4, 
        5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
         24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 
        41, 42, 43, 44, 45, 46, 47, 48, 49, 108, 89, 75, 65, 58, 54, 111, 92, 
        78, 68, 61, 114, 95, 81, 71, 118, 99, 85, 123, 104, 130, 50},
        VertexColors->Automatic]}},
     VertexColors->CompressedData["
1:eJxTTMoPSmViYGBoAmJmBhj4YM+AFYyKj4qPio+Kj4qPio+Kj4qPio+Kj4qP
ZHEAJqKcDw==
      "]], {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"Knife z\"", TraditionalForm], 
    FormBox["\"Beam diameter\"", TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Large,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
   "\"Beam diameter dependency fitting with ERF, \\!\\(\\*SuperscriptBox[\\(R\
\\), \\(2\\)]\\) = 0.998738\"", TraditionalForm],
  PlotRange->{{-5., 7.}, {0, 229.7178192441167}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.7222425394206624`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CalculateGauss", "[", "]"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Calculating", " ", "beam", " ", "diameter", " ", "with", " ", "Gauss", 
    " ", "function"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BeamGaussExport", "//", "TableForm"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Showing", " ", "calculated", " ", "data", " ", "in", " ", "a", " ", 
    "table"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Experiments", "\[GreaterEqual]", "4"}], ",", 
    RowBox[{"GetBeamPropogationFit", "[", 
     RowBox[{"BeamGaussPlot", ",", "\"\<Gauss\>\""}], "]"}], " ", ",", 
    "\"\<Not enough measured points for waist calculation \>\""}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Beam", " ", "parameters", " ", "calculating"}], " ", 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6974657537258334`*^9, 3.697465783313773*^9}, 
   3.6974679828038445`*^9, {3.697468182462687*^9, 3.697468182910993*^9}, {
   3.69786769848647*^9, 3.6978677068641214`*^9}, 3.6980493641417027`*^9, 
   3.6980494189393578`*^9, {3.6980502645246763`*^9, 3.698050272806157*^9}, {
   3.6982046770037518`*^9, 3.6982046791742735`*^9}, {3.6982047820639877`*^9, 
   3.698204806928952*^9}, {3.698206939893152*^9, 3.698206966552921*^9}, 
   3.6982078672871847`*^9, {3.6982079596801233`*^9, 3.6982079851309385`*^9}, {
   3.6982084850528717`*^9, 3.69820850710679*^9}, {3.6982139667310286`*^9, 
   3.698213989556279*^9}, 3.6982142982280893`*^9, {3.6983856871898756`*^9, 
   3.698385687377365*^9}, {3.709477984653758*^9, 3.709477985132098*^9}, 
   3.7095210533957167`*^9, 3.7095210942756696`*^9, {3.7095212397254252`*^9, 
   3.7095212438334794`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"R\"\>", "\<\"W\"\>", "\<\"dW\"\>"},
    {
     RowBox[{"-", "5.`"}], "199.67239211248972`", "43.13687092033055`"},
    {
     RowBox[{"-", "4.`"}], "187.81836914254544`", "7.0477884946500255`"},
    {
     RowBox[{"-", "3.`"}], "162.82125650832228`", "3.866351914905164`"},
    {"0.`", "55.58283479174251`", "1.3227902180978532`"},
    {"3.`", "109.02332492402573`", "1.8918457256737038`"},
    {"4.`", "133.61817337482483`", "2.0428649747194463`"},
    {"5.`", "154.95635252886132`", "2.1787758880008354`"},
    {"6.`", "191.296519340168`", "3.4197651741056654`"},
    {"7.`", "203.36134857034688`", "15.420528639351762`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7222425413904285`*^9}],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      PointBox[{{-5., 199.67239211248972`}, {-4., 187.81836914254544`}, {-3., 
       162.82125650832228`}, {0., 55.58283479174251}, {3., 
       109.02332492402573`}, {4., 133.61817337482483`}, {5., 
       154.95635252886132`}, {6., 191.296519340168}, {7., 
       203.36134857034688`}}], {{
        LineBox[{{-5., 242.80926303282027`}, {-5., 156.53552119215917`}}], 
        LineBox[{
         Offset[{1.5, 0}, {-5., 242.80926303282027`}], 
          Offset[{-1.5, 0}, {-5., 242.80926303282027`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {-5., 156.53552119215917`}], 
          Offset[{-1.5, 0}, {-5., 156.53552119215917`}]}]}, {
        LineBox[{{-4., 194.86615763719547`}, {-4., 180.7705806478954}}], 
        LineBox[{
         Offset[{1.5, 0}, {-4., 194.86615763719547`}], 
          Offset[{-1.5, 0}, {-4., 194.86615763719547`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {-4., 180.7705806478954}], 
          Offset[{-1.5, 0}, {-4., 180.7705806478954}]}]}, {
        LineBox[{{-3., 166.68760842322743`}, {-3., 158.95490459341713`}}], 
        LineBox[{
         Offset[{1.5, 0}, {-3., 166.68760842322743`}], 
          Offset[{-1.5, 0}, {-3., 166.68760842322743`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {-3., 158.95490459341713`}], 
          Offset[{-1.5, 0}, {-3., 158.95490459341713`}]}]}, {
        LineBox[{{0., 56.905625009840364`}, {0., 54.26004457364466}}], 
        LineBox[{
         Offset[{1.5, 0}, {0., 56.905625009840364`}], 
          Offset[{-1.5, 0}, {0., 56.905625009840364`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {0., 54.26004457364466}], 
          Offset[{-1.5, 0}, {0., 54.26004457364466}]}]}, {
        LineBox[{{3., 110.91517064969943`}, {3., 107.13147919835203`}}], 
        LineBox[{
         Offset[{1.5, 0}, {3., 110.91517064969943`}], 
          Offset[{-1.5, 0}, {3., 110.91517064969943`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {3., 107.13147919835203`}], 
          Offset[{-1.5, 0}, {3., 107.13147919835203`}]}]}, {
        LineBox[{{4., 135.66103834954427`}, {4., 131.5753084001054}}], 
        LineBox[{
         Offset[{1.5, 0}, {4., 135.66103834954427`}], 
          Offset[{-1.5, 0}, {4., 135.66103834954427`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {4., 131.5753084001054}], 
          Offset[{-1.5, 0}, {4., 131.5753084001054}]}]}, {
        LineBox[{{5., 157.13512841686216`}, {5., 152.77757664086047`}}], 
        LineBox[{
         Offset[{1.5, 0}, {5., 157.13512841686216`}], 
          Offset[{-1.5, 0}, {5., 157.13512841686216`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {5., 152.77757664086047`}], 
          Offset[{-1.5, 0}, {5., 152.77757664086047`}]}]}, {
        LineBox[{{6., 194.71628451427367`}, {6., 187.87675416606234`}}], 
        LineBox[{
         Offset[{1.5, 0}, {6., 194.71628451427367`}], 
          Offset[{-1.5, 0}, {6., 194.71628451427367`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {6., 187.87675416606234`}], 
          Offset[{-1.5, 0}, {6., 187.87675416606234`}]}]}, {
        LineBox[{{7., 218.78187720969865`}, {7., 187.9408199309951}}], 
        LineBox[{
         Offset[{1.5, 0}, {7., 218.78187720969865`}], 
          Offset[{-1.5, 0}, {7., 218.78187720969865`}]}], 
        LineBox[{
         Offset[{1.5, 0}, {7., 187.9408199309951}], 
          Offset[{-1.5, 0}, {7., 
           187.9408199309951}]}]}}}, {}}, {}, {}, {{}, {}}}, {
    GraphicsComplexBox[CompressedData["
1:eJwVlPc/lQ0Dh7MbCs33kREd8dK2Uo77m6S3HuoMxz4cI51bEoUmDaMkLXmM
TlLWkxWyukvnkPFEEZWyV4XSUDJy8PT+8P1c/8B1fTXcD7L2Ss6aNSvy9/5P
9bA7vdMzi0TRfbVRxUxv+JnNaR5U/yx8eKjHjzhpi2yjIfvr6+VRtDmA9WnM
CdGbd+rlZ6ihhcOesZXzhVuN1rUxf21M9xWr3jxwBIe+65SorFgP93zmX4Td
aZiMa0XJmBrg47OLX2m5YSg8Ml4/c28TVia20hs8I3Gw0rZxnQIdZIKG3ZTs
JSyTrm+PuQp4xtvJaq65ikb3tvPxNeY4Icj8/iQ8Bgvo7doSby2gonyRnlMc
i49TmunSnZbwcvAlctvjcPuETbui4k5UVEbviNqQiNaAYzJnVP7E/3JfOUe5
CPBZN/LDhI01xDqpCTwqCck1nenzQ/cgtaHKSBCejI9fF+VUVDFARZ+ZWJh4
G/6tOb2S3UxohNG7h6vugDpbrhTYz0Jl+cXolo4U+EXWCj5J28CU/kikMz8N
QaFBcetUOUhMKKkbMUoHfYsgKk3TFn7XTTNqrDLgzyxpUzezwwMaP1Di+N/w
0rLSemZpD83GOoetMXeRNRTauX2XA2LEC2LF6ZngLsz/8cTDEYmtc86oNWXh
xU87yQBvJ0TuuvVo+2A28oxHfHTOOaPfwCjh5bJcdPvo78hM4sJ98oxTO+6h
0XVI2SXFBcf0pUdHdPOwPj9x19LHrlDNnJRaV54HHV6PySwPHh5yT3H3W+eD
12Mp6/yOh8Pbi4ffNeejQSljFuXnBko6u1rJpwDqGpVjeT/csNE8qgpjBUjr
alPJPOOOnSXWMisv3Yd8cJ6ZqawHrk+6u8otL8Ty67b/MTzvAd+XEm910grB
cxxTX7/EE6XZG69MbS5CxIwNrTLeE8vqs3e/qi5CLzvH1lF7L+pW5Fi7uBTj
g8Yb2N3fizz5KjetH8Woqy/T/mzohYKCap8vwSX4oHvLNPyJF5yDnUu9F5ei
dy99d/GOfUBT1o+B5FJEKOcs2/10H07VRxum6j6AW8gyhQEOH03vw0oXih5A
pdxMankLH3o+zhqhf1IwjPupcWU/ia/kgJpeP4XPWR6q4hQ5UeujZmMbS3co
9pN9CQMjRNLqP9xeihn4ntmVNeW6FOu0tWTGC/dCZ3XiNY4miZK3XFW7BApL
HW2GxY0KotSardZepl7gqcf2xLg/JRwD3uvcvMQErU93aKXpQpTOqzvqXeqG
O0FDu0qn+L89/FvtwCEKkZPvr41+mhZKbONe37aQC+VYRpofSwpKPgKldg0O
cnt2tH63JPFMIlB1q4hCrH16TsiIkujgsPKGFRZ8xI+mdFjUNAv3sOu0DG+y
QT/FkDfWVQTdtfnpuSRXdN1YkkF+4qOA/lp93IVCi83++5MXpUQTk17FGi48
3DkvE1dWPUX4nlzXHRbLwidZf6NUAxLqEXTVZ9kUxBcErkOLB4h53Wv1YpMY
4Fn/fPyzbFTYN2e7svYtB/TtVTt1tlwOLF3a0yqOPQ49UgvZ6kCi8KKUWvFL
Co6+tH/Mfi0UxZRLXbLcRaJTcECzeus7oUvtD5nAMRvEJFZvOmO+AL2Zkk/L
KrkIWavLMe/lY6tPdDKdQ8Hj9L6BE/EyIrJpbfomhhtaSozLsuwmiDtJ0oK7
aUxcSAh/d1KPxM275jeVUii8apKwv3qgk6ANMCaPfmEgIPWzzuirX8Il+zMD
wxhOCAk2vjYRKYMAqR6n8UxbKO7RX63MIGHgn39z8imFF88LWn7qFQrDHON8
24JYKM4mS/uVJTBnYJhvXcHGjqWCOeePfSM6JgYYQSkMvPrv3Bd8dxIi0/1J
fh0UTI95vFYLXiQa2pVU/+Y5iYwDW8Rv8gaER4P+GFIq4iCZ3/LPBZP5uNL4
0u1SuzOeHzHIzu3g44jidx6PQUHnr/eSpkmyItfg7UYvat0Q0MB4oblijLjV
ZUHU7GCipffylsFVJPRDrLkGSRTMN3ilHrj8mrh8cWf5iAET0w2D3KBusfCb
fBjt/DpnWM2pXG7oK41+Fuvb4x4OXOPpoRF/kgg9e4WrVkVBPlPRxrypTrg4
0L7/oyQbcv5DoZbTM4TVbYb9MI2NKidvk+nQIeJGXZAt+y8GVh5erP2aSyL5
voFLzFsKuvHEVX5al1CcNGYSaGEDs2S1TIPLk8SC0xtT2EtY0Kfqw1vT+gi2
qjFN5RED3/yODG5IyCXSZpSd2L+YyJ4+O6qY/52YLTBsrvv9y2HdM0fFXiR0
tDI6rXsp5E5Ltl96vEhk8mVJTZmCN+RtNQd5Ax+Ftc+PnYhYZov0ht4rCkXy
KHiTP1RFOiNA8OCNZxsfa86tKh+2pjD3Nk1RRUNOZJaW/SZwtjvMnTocXKRH
Ce89liGd6kyclluy7xaNRMQvm7KqGxSO8eJrnVY0El3uL/0DXJmofL/vqNGH
KeH4vNluAcnO0N9zoZvVLYXHdZ7V105zIFtWkWu6k4Tx4rNl9yooNGg1S+nb
Nwnnz2Rs4+5m45X46PyzvdPEKVP1K/w2FniHQ60CrT4SmyP9imriGKiNS2BF
OZG4f3j5Y1ozheOFEYb0ub1CyXyppssCG8ivztL3O/yLEGaftHBoY6K+sT+e
6dtDrB46WfSg6XePnPaYw8GhwtYgl9tXjVg4fkHhtFXsMKGoZTRXooCB1TLh
qQWeJDaHnzfr6qKQvq3Ssn/LODHqJd7mE8DEPEmDkFPTLcTuwcRPUGDi+OzA
ZLWRCuFV2KvIPWRB14K56tzDL0QdRznIJJGB+DtFhzw63hNrahl6RZkM1AdP
rPELExHuBK96ZwUTnYdGfV4/+0FMg725spOB9ofHrS1JEmtUakIevaPwL/H2
Fdw=
     "], {{}, {}, 
      {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
       Opacity[1.], 
       LineBox[{1, 109, 88, 73, 62, 55, 51, 113, 92, 77, 66, 59, 117, 96, 81, 
        70, 2, 110, 89, 74, 124, 103, 63, 120, 99, 132, 84, 127, 106, 135, 56,
         116, 95, 131, 80, 126, 105, 134, 69, 122, 101, 133, 86, 128, 107, 
        136, 52, 114, 93, 130, 78, 125, 104, 67, 121, 100, 85, 60, 118, 97, 
        82, 71, 3, 111, 90, 75, 64, 57, 53, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 
        14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 
        31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 
        48, 49, 112, 91, 76, 65, 58, 54, 115, 94, 79, 68, 61, 119, 98, 83, 72,
         123, 102, 87, 129, 108, 137, 50},
        VertexColors->Automatic]}},
     VertexColors->CompressedData["
1:eJxTTMoPSmViYGDoBGJmBhj4YM+AFYyKj4qPio+Kj4qPio+Kj4qPio+Kj4qP
ig9+cQDYsqRf
      "]], {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"Knife z\"", TraditionalForm], 
    FormBox["\"Beam diameter\"", TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Large,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
   "\"Beam diameter dependency fitting with Gauss, \
\\!\\(\\*SuperscriptBox[\\(R\\), \\(2\\)]\\) = 0.995032\"", TraditionalForm],
  PlotRange->{{-5., 7.}, {0, 203.36134857034688`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.7222425416560564`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ERFandGaussPlot", "=", 
   RowBox[{"ErrorListPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"BeamERFPlot", ",", "BeamGaussPlot"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "PlotLabel", "\[Rule]", 
      "\"\<Beam diameters : ERF(Blue), Gauss(Orange)\>\""}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Knife z\>\"", ",", "\"\<Beam diameter\>\""}], "}"}]}], 
     ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Plotting", " ", "everything", " ", "in", " ", "one", " ", "Plot"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"exportDir", ",", "\"\<ERFandGaussBeamDiameterPlot.png\>\""}], 
       "}"}], "]"}], ",", "ERFandGaussPlot"}], "]"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Exporting", " ", "previous", " ", "plot"}], " ", 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6982056697671547`*^9, 3.698205800939767*^9}, {
   3.698205874295519*^9, 3.6982059103310485`*^9}, {3.6982088292359047`*^9, 
   3.6982088407473197`*^9}, {3.6982088754273443`*^9, 3.698208917580286*^9}, {
   3.6982098835178285`*^9, 3.6982098864378953`*^9}, {3.698213079678548*^9, 
   3.6982130803045053`*^9}, {3.6982140001361403`*^9, 
   3.6982140413484488`*^9}, {3.69821428100766*^9, 3.6982142811197405`*^9}, {
   3.6983905226711407`*^9, 3.698390540586795*^9}, {3.6983906527278585`*^9, 
   3.698390654033781*^9}, 3.6985660517783813`*^9, {3.7093833060223646`*^9, 
   3.7093833281418943`*^9}, 3.709523109741372*^9, 3.710079709951209*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{-5., 209.67606661226708`}, {-4., 187.03253685478094`}, {-3., 
      155.0897916493461}, {0., 52.15192585800813}, {3., 
      105.93482327569016`}, {4., 134.65690803525865`}, {5., 
      161.31907068853198`}, {6., 199.72381652222393`}, {7., 
      229.7178192441167}}], {{
       LineBox[{{-5., 220.69629367729416`}, {-5., 198.65583954724}}], 
       LineBox[{
        Offset[{1.5, 0}, {-5., 220.69629367729416`}], 
         Offset[{-1.5, 0}, {-5., 220.69629367729416`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {-5., 198.65583954724}], 
         Offset[{-1.5, 0}, {-5., 198.65583954724}]}]}, {
       LineBox[{{-4., 189.99450374952028`}, {-4., 184.0705699600416}}], 
       LineBox[{
        Offset[{1.5, 0}, {-4., 189.99450374952028`}], 
         Offset[{-1.5, 0}, {-4., 189.99450374952028`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {-4., 184.0705699600416}], 
         Offset[{-1.5, 0}, {-4., 184.0705699600416}]}]}, {
       LineBox[{{-3., 156.59714303952362`}, {-3., 153.58244025916858`}}], 
       LineBox[{
        Offset[{1.5, 0}, {-3., 156.59714303952362`}], 
         Offset[{-1.5, 0}, {-3., 156.59714303952362`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {-3., 153.58244025916858`}], 
         Offset[{-1.5, 0}, {-3., 153.58244025916858`}]}]}, {
       LineBox[{{0., 53.54658544431475}, {0., 50.7572662717015}}], 
       LineBox[{
        Offset[{1.5, 0}, {0., 53.54658544431475}], 
         Offset[{-1.5, 0}, {0., 53.54658544431475}]}], 
       LineBox[{
        Offset[{1.5, 0}, {0., 50.7572662717015}], 
         Offset[{-1.5, 0}, {0., 50.7572662717015}]}]}, {
       LineBox[{{3., 107.35377553421068`}, {3., 104.51587101716964`}}], 
       LineBox[{
        Offset[{1.5, 0}, {3., 107.35377553421068`}], 
         Offset[{-1.5, 0}, {3., 107.35377553421068`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {3., 104.51587101716964`}], 
         Offset[{-1.5, 0}, {3., 104.51587101716964`}]}]}, {
       LineBox[{{4., 135.55145440833752`}, {4., 133.76236166217979`}}], 
       LineBox[{
        Offset[{1.5, 0}, {4., 135.55145440833752`}], 
         Offset[{-1.5, 0}, {4., 135.55145440833752`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {4., 133.76236166217979`}], 
         Offset[{-1.5, 0}, {4., 133.76236166217979`}]}]}, {
       LineBox[{{5., 162.5642365282953}, {5., 160.07390484876865`}}], 
       LineBox[{
        Offset[{1.5, 0}, {5., 162.5642365282953}], 
         Offset[{-1.5, 0}, {5., 162.5642365282953}]}], 
       LineBox[{
        Offset[{1.5, 0}, {5., 160.07390484876865`}], 
         Offset[{-1.5, 0}, {5., 160.07390484876865`}]}]}, {
       LineBox[{{6., 201.15973642761213`}, {6., 198.28789661683572`}}], 
       LineBox[{
        Offset[{1.5, 0}, {6., 201.15973642761213`}], 
         Offset[{-1.5, 0}, {6., 201.15973642761213`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {6., 198.28789661683572`}], 
         Offset[{-1.5, 0}, {6., 198.28789661683572`}]}]}, {
       LineBox[{{7., 234.57842104146354`}, {7., 224.85721744676985`}}], 
       LineBox[{
        Offset[{1.5, 0}, {7., 234.57842104146354`}], 
         Offset[{-1.5, 0}, {7., 234.57842104146354`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {7., 224.85721744676985`}], 
         Offset[{-1.5, 0}, {7., 224.85721744676985`}]}]}}}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{-5., 199.67239211248972`}, {-4., 187.81836914254544`}, {-3., 
      162.82125650832228`}, {0., 55.58283479174251}, {3., 
      109.02332492402573`}, {4., 133.61817337482483`}, {5., 
      154.95635252886132`}, {6., 191.296519340168}, {7., 
      203.36134857034688`}}], {{
       LineBox[{{-5., 242.80926303282027`}, {-5., 156.53552119215917`}}], 
       LineBox[{
        Offset[{1.5, 0}, {-5., 242.80926303282027`}], 
         Offset[{-1.5, 0}, {-5., 242.80926303282027`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {-5., 156.53552119215917`}], 
         Offset[{-1.5, 0}, {-5., 156.53552119215917`}]}]}, {
       LineBox[{{-4., 194.86615763719547`}, {-4., 180.7705806478954}}], 
       LineBox[{
        Offset[{1.5, 0}, {-4., 194.86615763719547`}], 
         Offset[{-1.5, 0}, {-4., 194.86615763719547`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {-4., 180.7705806478954}], 
         Offset[{-1.5, 0}, {-4., 180.7705806478954}]}]}, {
       LineBox[{{-3., 166.68760842322743`}, {-3., 158.95490459341713`}}], 
       LineBox[{
        Offset[{1.5, 0}, {-3., 166.68760842322743`}], 
         Offset[{-1.5, 0}, {-3., 166.68760842322743`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {-3., 158.95490459341713`}], 
         Offset[{-1.5, 0}, {-3., 158.95490459341713`}]}]}, {
       LineBox[{{0., 56.905625009840364`}, {0., 54.26004457364466}}], 
       LineBox[{
        Offset[{1.5, 0}, {0., 56.905625009840364`}], 
         Offset[{-1.5, 0}, {0., 56.905625009840364`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {0., 54.26004457364466}], 
         Offset[{-1.5, 0}, {0., 54.26004457364466}]}]}, {
       LineBox[{{3., 110.91517064969943`}, {3., 107.13147919835203`}}], 
       LineBox[{
        Offset[{1.5, 0}, {3., 110.91517064969943`}], 
         Offset[{-1.5, 0}, {3., 110.91517064969943`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {3., 107.13147919835203`}], 
         Offset[{-1.5, 0}, {3., 107.13147919835203`}]}]}, {
       LineBox[{{4., 135.66103834954427`}, {4., 131.5753084001054}}], 
       LineBox[{
        Offset[{1.5, 0}, {4., 135.66103834954427`}], 
         Offset[{-1.5, 0}, {4., 135.66103834954427`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {4., 131.5753084001054}], 
         Offset[{-1.5, 0}, {4., 131.5753084001054}]}]}, {
       LineBox[{{5., 157.13512841686216`}, {5., 152.77757664086047`}}], 
       LineBox[{
        Offset[{1.5, 0}, {5., 157.13512841686216`}], 
         Offset[{-1.5, 0}, {5., 157.13512841686216`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {5., 152.77757664086047`}], 
         Offset[{-1.5, 0}, {5., 152.77757664086047`}]}]}, {
       LineBox[{{6., 194.71628451427367`}, {6., 187.87675416606234`}}], 
       LineBox[{
        Offset[{1.5, 0}, {6., 194.71628451427367`}], 
         Offset[{-1.5, 0}, {6., 194.71628451427367`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {6., 187.87675416606234`}], 
         Offset[{-1.5, 0}, {6., 187.87675416606234`}]}]}, {
       LineBox[{{7., 218.78187720969865`}, {7., 187.9408199309951}}], 
       LineBox[{
        Offset[{1.5, 0}, {7., 218.78187720969865`}], 
         Offset[{-1.5, 0}, {7., 218.78187720969865`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {7., 187.9408199309951}], 
         Offset[{-1.5, 0}, {7., 
          187.9408199309951}]}]}}}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"Knife z\"", TraditionalForm], 
    FormBox["\"Beam diameter\"", TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Large,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
   "\"Beam diameters : ERF(Blue), Gauss(Orange)\"", TraditionalForm],
  PlotRange->{{-5., 7.}, {0, 229.7178192441167}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.7222425417185564`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BeamProfiles", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"MyDerivative", "[", 
       RowBox[{"AllData", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", 
          RowBox[{"3", ";;"}], ",", 
          RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "2", ",", 
        RowBox[{"Length", "[", "AllData", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Calculating", " ", "beam", " ", "profiles"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"BeamProfilesPlot", "=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"BeamProfiles", ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Beam Profiles UOGRVB\>\""}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Knife z\>\"", ",", "\"\<Intensity A.U.\>\""}], "}"}]}]}], 
    "]"}]}], 
  RowBox[{"(*", " ", 
   RowBox[{"Plotting", " ", "beam", " ", "profiles"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"exportDir", ",", "\"\<BeamProfilesPlot.png\>\""}], "}"}], 
      "]"}], ",", "BeamProfilesPlot"}], "]"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Exporting", " ", "previous", " ", "plot"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"exportDir", ",", "\"\<BeamProfiles.xlsx\>\""}], "}"}], "]"}], 
     ",", "BeamProfiles"}], "]"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Exporting", " ", "beam", " ", "profiles", " ", "raw", " ", "data"}], " ", 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.70887042594632*^9, 3.708870489590436*^9}, {
  3.7088705263661623`*^9, 3.708870634062107*^9}, {3.7088706987055435`*^9, 
  3.708870794908012*^9}, {3.7088710466568995`*^9, 3.7088710879949837`*^9}, {
  3.7090511486289988`*^9, 3.7090511511467752`*^9}, {3.709347953118347*^9, 
  3.709347953337098*^9}, {3.709519933005371*^9, 3.7095199399650364`*^9}, {
  3.7095199899973564`*^9, 3.7095199946257577`*^9}, {3.7095200247235055`*^9, 
  3.709520034272915*^9}, {3.709520156861018*^9, 3.709520197770913*^9}, {
  3.709520451383042*^9, 3.7095204811739197`*^9}, {3.70952060619747*^9, 
  3.709520606275597*^9}, {3.709521026400914*^9, 3.709521026947796*^9}, {
  3.7095213730272636`*^9, 3.709521375849272*^9}, {3.709521538566635*^9, 
  3.7095215525878487`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGCQBWIQDQYNiQdMjEHgsD1EIO7ArJkgsBPKjzxgjCIfciA9
DQTuQfl+UPUvoXzPA2fPgMAHKN8Fqv4XlG8HtY/RAcI3gepnhfJVDkBoDgcG
FADjqzhA9AvA9ENpUSht5wC275kKlO/iALY+DSbviWauH5QvBKEbAh0g7hGE
iodAaah9DWFQeW6oeCSUZoPKRztA/M8AFY+Duvc3xP8OCQ7nwPJfIPyGRKg6
aHgdSILqfwINrxSofTeh6tOg/JNQ+UwHWHwBAB4+biI=
      "]]}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGCQA2IQDQYNiQcYkIFDwoFZM0FgpT1EIA6NHwnlz4TyQ6D6
D0D5fgfOnQGBO1C+54GMNBB4B+W7QOW/QPl2UP4fKN8Eah6LA4RWgfI5HGBO
hNjPDZN3MDEGAV4o38QBIs8P5ds5nAWbLwLlu0DlxaB8T6i8OJTvB+VLQPgN
gVC+KFQ+BMoXhsqHQcUFoHSkA8Q/UPc2RDukg/3PBJWPg8r/sIeGN9S8DxB+
QyLUfQ8h/ANJUP3XoOGTAuUfg6pPc0CNn0w4HwANhY+3
      "]]}, 
    {RGBColor[0.560181, 0.691569, 0.194885], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGCQAmIQDQYHkg4IgsFCe4hA3AEhML8Ryo88MGsmGED5IQdM
jEFgM5TvdwBqEJTvCVV/E8p3gfJfQvl2B9LTQOAXlG9y4NwZEGBxgPBVDmSA
5fkcYE6E2CcMk3eAmCcC5ZtA+RJQvh2ULwPluzhA9EtD+Z4OEPsloXw/KA3V
3xAIVS8KFQ9xACtPE4TKh0Hl2aHykVD+f4h/GqKh5n+ChSfUPQ8hfIcEqPrL
UPWJUP5he2h8QNXvtAcAPHViig==
      "]]}, 
    {RGBColor[0.922526, 0.385626, 0.209179], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], 
     LineBox[{{-20., 0.05}, {0., 0.47500000000000003`}, {10., 
      3.0000000000000004`}, {20., 9.850000000000001}, {30., 18.3}, {40., 
      18.3}, {50., 11.350000000000001`}, {60., 5.2}, {70., 1.6}, {80., 
      0.55}, {90., 0.15000000000000002`}, {100., 0.05}, {110., 0.}, {120., 
      0.}}]}, 
    {RGBColor[0.528488, 0.470624, 0.701351], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQDQF+BxhQgMuBs2dA4Io9hG9ywBgMPkL5KgdMwHxO
B5iOc2D1glC+CpSWgdImELpBCcq3c5g1EwSUoXwXqDyM7wmlFaC0nwPEPimo
ukCoOMy+EKh5jFD5MKj4B6h7Ix0g/rkD4TdEQ9WfhMrHQfkrofKJqHyGFLg/
IfJpqHyGTDgfAOjMQPU=
      "]]}, 
    {RGBColor[0.772079, 0.431554, 0.102387], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGCQAmIQDQGRB2bNBIGV9hB+yAEIfQDK9zuQBgb3oHyXA2fP
gMALKN8Oqv8nlG9yIB2sns0BwleBqhdwgNloYgwC4jB5KC0DpU0cIObJQvl2
DmDlxgpQvgsa39MBYr4UlO8H1S8C4TcEOkDs44XKh0BpqPsawqDyv6Huj4Ty
X0P4DdFQ9Q+g8nFQ8y9C5ROh/J1Q+RQofyZUPg3ubwjIRJPPRuUz5MHVAwD7
L2II
      "]]}, 
    {RGBColor[0.363898, 0.618501, 0.782349], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGCQA2IQDQGRB2bNBIGT9hB+yIGzZ0DgCpTvd8AYDJ5D+S4H
IPQXKN/ugAlY/j+Ub3IgPQ0E2BwgfBUon8cBZiNEvTBM3gHCF4fyTRwg7pGA
8u2g8tJQvguUloHSnlBaEkr7QdWLQfgNgVBxISgdApXnhMqHQe1jhMpHOpwD
+/8HxD8N0VD1n6H+i4OqfwnhOyRA1d+Bqk+EmnMBwj+Q5IAavilQ+QNQ9WlQ
+ZVQ+UwofyZUPhsebhCQhyrvUICmvhCuHgBrj2x2
      "]]}, 
    {RGBColor[1, 0.75, 0], PointSize[0.009166666666666668], AbsoluteThickness[
     1.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGBQAmIQDQEpB2bNBIGV9mBuQyKUvxPCZ4g7kJ4GAseg/MgD
Z8+AwBUoP+SAMRg8h/L9oPo/Q/kuBxjB9D8o3+6ACVg9qwOEbwI1jwvKVzkA
ti5NwAHmQoh6EZi8A8R8MZh+B4h6GN8OSotCaRcHiPkw/Z5Q/cJQvh9UvyCE
3xAI5fNB5UMcIP7ngMqHQflMUPlIKP0HGn7RUPu+wMIPat47CN8hwQHin9ew
8IbyH0P4B5Kg6q9B9ac4oIR/Q5oDavxkOqDGXzaUPxMqnwcPR4j9BajyDYWo
/ANFcPUAtjqM9w==
      "]]}, 
    {RGBColor[0.647624, 0.37816, 0.614037], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGBQBmIQDQEpB86eAYE79mBuQ+KBWTNB4CSEzxAH5V+E8iMP
mBiDwG0oP+RAehoIPIPy/aD8D1C+J1T/Vyjf5QBYuzGzA4Rvh8Y3OQCh/0DV
q0D1w+RhgAvKV3GAuIcXpt8Bol4UZr4DxD2SUL4LlBaA0p4O58D+54Py/aDm
QeUbAqHmCULlQ6C0CFQ+DCrPCRWPhOqHurchGir/ExaeDpDwhoaPQ4ID2Hlp
72DhD5V/A+EfSELlM6RA1UPDuyENau8NqHwmVP0ZqHw2VP4AVD4P6p6VUPsL
oPyZUPWFqPwDRXD1ABW1lvE=
      "]]}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"Knife z\"", TraditionalForm], 
    FormBox["\"Intensity A.U.\"", TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Large,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"Beam Profiles UOGRVB\"", TraditionalForm],
  PlotRange->{{-160., 300.}, {0, 18.3}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.722242541906059*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ERFandGaussBeamCentresPlot", "=", 
   RowBox[{"ErrorListPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"BeamERFCenterPlot", ",", "BeamGaussCenterPlot"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "PlotLabel", "\[Rule]", 
      "\"\<Beam centers : ERF(Blue), Gauss(Orange)\>\""}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Knife z\>\"", ",", "\"\<Beam center\>\""}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Plotting", " ", "dependency", " ", "of", " ", "beam", " ", "centers", " ",
     "from", " ", "Knife", " ", "z"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"exportDir", ",", "\"\<Beam centers.png\>\""}], "}"}], "]"}], 
     ",", "ERFandGaussBeamCentresPlot"}], "]"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Exporting", " ", "previous", " ", "plot"}], " ", 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7093831156195226`*^9, 3.709383181856104*^9}, {
   3.709383223124053*^9, 3.709383225210569*^9}, 3.7094804339260406`*^9, {
   3.709956699212878*^9, 3.7099567227490363`*^9}, {3.7099567675833745`*^9, 
   3.7099567756361084`*^9}, {3.7099576288142776`*^9, 3.709957663156464*^9}, 
   3.7100797168917713`*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{-5., 38.64750744553999}, {-4., 47.1035634883818}, {-3., 
      37.52777033114845}, {0., 36.49700736847893}, {3., 33.41198741601177}, {
      4., 29.05301940798285}, {5., 32.987767897468245`}, {6., 
      26.887759322466597`}, {7., 
      38.86993217452938}}], {{
       LineBox[{{-5., 40.65574358028711}, {-5., 36.63927131079288}}], 
       LineBox[{
        Offset[{1.5, 0}, {-5., 40.65574358028711}], 
         Offset[{-1.5, 0}, {-5., 40.65574358028711}]}], 
       LineBox[{
        Offset[{1.5, 0}, {-5., 36.63927131079288}], 
         Offset[{-1.5, 0}, {-5., 36.63927131079288}]}]}, {
       LineBox[{{-4., 47.65143667410937}, {-4., 46.555690302654234`}}], 
       LineBox[{
        Offset[{1.5, 0}, {-4., 47.65143667410937}], 
         Offset[{-1.5, 0}, {-4., 47.65143667410937}]}], 
       LineBox[{
        Offset[{1.5, 0}, {-4., 46.555690302654234`}], 
         Offset[{-1.5, 0}, {-4., 46.555690302654234`}]}]}, {
       LineBox[{{-3., 37.80478879280041}, {-3., 37.2507518694965}}], 
       LineBox[{
        Offset[{1.5, 0}, {-3., 37.80478879280041}], 
         Offset[{-1.5, 0}, {-3., 37.80478879280041}]}], 
       LineBox[{
        Offset[{1.5, 0}, {-3., 37.2507518694965}], 
         Offset[{-1.5, 0}, {-3., 37.2507518694965}]}]}, {
       LineBox[{{0., 36.75711913600283}, {0., 36.23689560095504}}], 
       LineBox[{
        Offset[{1.5, 0}, {0., 36.75711913600283}], 
         Offset[{-1.5, 0}, {0., 36.75711913600283}]}], 
       LineBox[{
        Offset[{1.5, 0}, {0., 36.23689560095504}], 
         Offset[{-1.5, 0}, {0., 36.23689560095504}]}]}, {
       LineBox[{{3., 33.68143060759614}, {3., 33.1425442244274}}], 
       LineBox[{
        Offset[{1.5, 0}, {3., 33.68143060759614}], 
         Offset[{-1.5, 0}, {3., 33.68143060759614}]}], 
       LineBox[{
        Offset[{1.5, 0}, {3., 33.1425442244274}], 
         Offset[{-1.5, 0}, {3., 33.1425442244274}]}]}, {
       LineBox[{{4., 29.222275447952416`}, {4., 28.88376336801328}}], 
       LineBox[{
        Offset[{1.5, 0}, {4., 29.222275447952416`}], 
         Offset[{-1.5, 0}, {4., 29.222275447952416`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {4., 28.88376336801328}], 
         Offset[{-1.5, 0}, {4., 28.88376336801328}]}]}, {
       LineBox[{{5., 33.22631366028061}, {5., 32.74922213465588}}], 
       LineBox[{
        Offset[{1.5, 0}, {5., 33.22631366028061}], 
         Offset[{-1.5, 0}, {5., 33.22631366028061}]}], 
       LineBox[{
        Offset[{1.5, 0}, {5., 32.74922213465588}], 
         Offset[{-1.5, 0}, {5., 32.74922213465588}]}]}, {
       LineBox[{{6., 27.158896613094406`}, {6., 26.616622031838787`}}], 
       LineBox[{
        Offset[{1.5, 0}, {6., 27.158896613094406`}], 
         Offset[{-1.5, 0}, {6., 27.158896613094406`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {6., 26.616622031838787`}], 
         Offset[{-1.5, 0}, {6., 26.616622031838787`}]}]}, {
       LineBox[{{7., 39.790874080582796`}, {7., 37.94899026847597}}], 
       LineBox[{
        Offset[{1.5, 0}, {7., 39.790874080582796`}], 
         Offset[{-1.5, 0}, {7., 39.790874080582796`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {7., 37.94899026847597}], 
         Offset[{-1.5, 0}, {7., 37.94899026847597}]}]}}}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{-5., 37.43496117199725}, {-4., 48.36487740126769}, {-3., 
      37.49384412259331}, {0., 36.06008431133459}, {3., 33.38466040248973}, {
      4., 29.08962200659305}, {5., 33.30233541195955}, {6., 
      26.720264524782923`}, {7., 
      40.15465537531133}}], {{
       LineBox[{{-5., 44.49632554057992}, {-5., 30.373596803414586`}}], 
       LineBox[{
        Offset[{1.5, 0}, {-5., 44.49632554057992}], 
         Offset[{-1.5, 0}, {-5., 44.49632554057992}]}], 
       LineBox[{
        Offset[{1.5, 0}, {-5., 30.373596803414586`}], 
         Offset[{-1.5, 0}, {-5., 30.373596803414586`}]}]}, {
       LineBox[{{-4., 49.61627361759211}, {-4., 47.113481184943275`}}], 
       LineBox[{
        Offset[{1.5, 0}, {-4., 49.61627361759211}], 
         Offset[{-1.5, 0}, {-4., 49.61627361759211}]}], 
       LineBox[{
        Offset[{1.5, 0}, {-4., 47.113481184943275`}], 
         Offset[{-1.5, 0}, {-4., 47.113481184943275`}]}]}, {
       LineBox[{{-3., 38.1624102077498}, {-3., 36.82527803743682}}], 
       LineBox[{
        Offset[{1.5, 0}, {-3., 38.1624102077498}], 
         Offset[{-1.5, 0}, {-3., 38.1624102077498}]}], 
       LineBox[{
        Offset[{1.5, 0}, {-3., 36.82527803743682}], 
         Offset[{-1.5, 0}, {-3., 36.82527803743682}]}]}, {
       LineBox[{{0., 36.344714806264655`}, {0., 35.77545381640453}}], 
       LineBox[{
        Offset[{1.5, 0}, {0., 36.344714806264655`}], 
         Offset[{-1.5, 0}, {0., 36.344714806264655`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {0., 35.77545381640453}], 
         Offset[{-1.5, 0}, {0., 35.77545381640453}]}]}, {
       LineBox[{{3., 33.762220850067564`}, {3., 33.007099954911894`}}], 
       LineBox[{
        Offset[{1.5, 0}, {3., 33.762220850067564`}], 
         Offset[{-1.5, 0}, {3., 33.762220850067564`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {3., 33.007099954911894`}], 
         Offset[{-1.5, 0}, {3., 33.007099954911894`}]}]}, {
       LineBox[{{4., 29.501570601833283`}, {4., 28.677673411352817`}}], 
       LineBox[{
        Offset[{1.5, 0}, {4., 29.501570601833283`}], 
         Offset[{-1.5, 0}, {4., 29.501570601833283`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {4., 28.677673411352817`}], 
         Offset[{-1.5, 0}, {4., 28.677673411352817`}]}]}, {
       LineBox[{{5., 33.73803494779852}, {5., 32.866635876120576`}}], 
       LineBox[{
        Offset[{1.5, 0}, {5., 33.73803494779852}], 
         Offset[{-1.5, 0}, {5., 33.73803494779852}]}], 
       LineBox[{
        Offset[{1.5, 0}, {5., 32.866635876120576`}], 
         Offset[{-1.5, 0}, {5., 32.866635876120576`}]}]}, {
       LineBox[{{6., 27.386722687863212`}, {6., 26.053806361702634`}}], 
       LineBox[{
        Offset[{1.5, 0}, {6., 27.386722687863212`}], 
         Offset[{-1.5, 0}, {6., 27.386722687863212`}]}], 
       LineBox[{
        Offset[{1.5, 0}, {6., 26.053806361702634`}], 
         Offset[{-1.5, 0}, {6., 26.053806361702634`}]}]}, {
       LineBox[{{7., 43.1226150625794}, {7., 37.18669568804326}}], 
       LineBox[{
        Offset[{1.5, 0}, {7., 43.1226150625794}], 
         Offset[{-1.5, 0}, {7., 43.1226150625794}]}], 
       LineBox[{
        Offset[{1.5, 0}, {7., 37.18669568804326}], 
         Offset[{-1.5, 0}, {7., 
          37.18669568804326}]}]}}}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"Knife z\"", TraditionalForm], 
    FormBox["\"Beam center\"", TraditionalForm]},
  AxesOrigin->{0, 25.638033880958687`},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Large,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
   "\"Beam centers : ERF(Blue), Gauss(Orange)\"", TraditionalForm],
  PlotRange->{{-5., 7.}, {26.720264524782923`, 48.36487740126769}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.722242542171687*^9}]
}, Open  ]]
},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{595.3199999999999, 841.92}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 766, 14, 87, "Text"],
Cell[1327, 36, 658, 12, 47, "Input"],
Cell[1988, 50, 657, 13, 47, "Input"],
Cell[2648, 65, 7063, 117, 182, "Input"],
Cell[9714, 184, 376, 10, 50, "Input"],
Cell[10093, 196, 735, 16, 47, "Input"],
Cell[10831, 214, 2669, 62, 198, "Input"],
Cell[13503, 278, 4506, 122, 364, "Input"],
Cell[18012, 402, 2793, 71, 210, "Input"],
Cell[20808, 475, 18655, 427, 1543, "Input"],
Cell[39466, 904, 6281, 150, 358, "Input"],
Cell[45750, 1056, 26628, 558, 1608, "Input"],
Cell[72381, 1616, 21714, 453, 1262, "Input"],
Cell[CellGroupData[{
Cell[94120, 2073, 1804, 35, 124, "Input"],
Cell[95927, 2110, 1181, 28, 196, "Output"],
Cell[97111, 2140, 8679, 171, 392, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105827, 2316, 1770, 35, 124, "Input"],
Cell[107600, 2353, 1181, 28, 196, "Output"],
Cell[108784, 2383, 8890, 175, 392, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117711, 2563, 1728, 39, 124, "Input"],
Cell[119442, 2604, 8206, 177, 389, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127685, 2786, 2711, 65, 198, "Input"],
Cell[130399, 2853, 5209, 107, 389, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135645, 2965, 1498, 35, 143, "Input"],
Cell[137146, 3002, 8141, 177, 394, "Output"]
}, Open  ]]
}
]
*)

